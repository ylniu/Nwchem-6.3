<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>NWChem Version 4.1 Release Notes</title>
<link rel="stylesheet" type="text/css" href="../shared/nwchem_basic.css">
</head>
<br>
<br>
<body text="#000000" bgcolor="#FFFFFF" link="blue" alink="blue" vlink="blue">
<table width="650"><tr><td>
<br>
<table>
<tbody>
<tr>
<td align="left" width="325"><img src="../images/nwchem_logo_dark.gif" border=0 width=200 alt="NWChem - computational chemistry on parallel computers"></td>
<td align="right" width="325" valign="bottom">
<a href="../nwchem_main.html">NWChem Home</a> |
<a href="../disclaimer.html">Security & Privacy</a> |
<a href="http://www.pnl.gov" target="_blank">PNNL</a>
</td>
</tr>
</tbody>
</table>
<hr>
<h1>NWChem Version 4.1 Notes</h1>
<p>
<font color="red">NOTE:</font> These release notes are not a substitute for reading the
<a href="../doc/user/index.html">User Manual</a>! They are meant to give a
thumbnail sketch of the new capabilities and bug fixes that are available in
NWChem Version 4.1. When there is a conflict between the release notes and the
<a href="../doc/user/index.html">User Manual</a>, the User Manual takes precedence.

<p>
Several new major capabilities are available in NWChem, including several new
modules. The new modules are:

<ul>
	<li>HESSIAN: This module controls the analytic hessian calculation.</li>
    <li>DIRDYVTST: The DIRect Dynamics for Variational Transition State Theory.</li>
  	<li>BAND: Prototype Band structure code.</li>
</ul>

For each of these capabilities, the user is referred to the
<a href="../doc/user/index.html">User Manual</a> for more information.

<p>
<b>Additional major additions to the capabilities include:</b>
<ul>
	<li>The AUTOSYM directive in the GEOMETRY group is now ON by default, except
    for atoms.</li>
    <li>Third order Douglas-Kroll from Kimihiko Hirao's group at the University
    of Tokyo.</li>
    <li>NBO 5.0 is now available.</li>
    <li>A limited memory BFGS minimization has been added to the PSPW code.</li>
  	<li>New density functionals, B97-2, HCTC P1/4 and OPTX have been added.</li>
    <li>A robust algorithm of eliminating linear dependence in basis functions
    has been implemented in DFT.</li>
    <li>A new SCF convergence scheme based on fractional occupation numbers has
    <li>been implemented in DFT (with keyword SMEAR).</li>
    <li>Charge density fitting calculations has improved performance.</li>
    <li>Wildcard "*" can be used in basis set, ECP, SO basis set input.</li>
   <li>Input for the PSPW module is more "user-friendly".</li>
 </ul>
Again, for each of these capabilities, the user is referred to the
<a href="../doc/user/index.html">User Manual</a> for more information.
<p>
Listed below are the other major and many minor changes for each module
with significant changes. These descriptions are somewhat terse and more
information is generally available in the
<a href="../doc/user/index.html">User Manual.</a>
<p>
<font color="red">NOTE:</font>  Due to changes in the runtime database structure, RESTART
will not work on database files generated by NWChem versions 4.1 and older.
<p>
<b>Top level directives:</b>
<ul>
    <li><font color="red">BUG FIX:</font>  Problems on some platforms with a title longer than 80
    characters has been fixed.</li>
   <li><font color="red">BUG FIX:</font>  TASK SHELL now returns properly for DECOSF.</li>
</ul>
<p>
<b>Initial orbital Guess: </b>
<ul>
  <li>Maximum number of fragment systems has been increased to 60.</li>
</ul>

<p>
<b>Basis Sets:</b>
<ul>

  <li>The "*" tag is introduced in the basis set input block to increase the user
    flexibility and ease when creating the basis set input. When a star tag is
    used the code will use the geometry and assign the basis set defined
    at the star tag line to all atoms in the geometry. In addition an "except"
    keyword is introduced. Other new tags possible are bq* and <tag string>*.</li>
  <li>Basis set library file has been split into one file per basis set to allow
    for easier access. These files are located in the directory "libraries".</li>
  <li>Blanks (spaces) in basis set names have been replaced by underscores.</li>
  <li><font color="red">BUG FIX:</font> An error in Ne DGauss_A1_DFT_Exchange_Fitting has been corrected.</li>
 </ul>

 <p>

<b>Geometry:</b>
<ul>
  <li>The AUTOSYM directive has been improved and is now ON by default, except
    for atoms.</li>
  <li><font color="red">BUG FIX:</font> AUTOSYM now uses tags instead of nuclear charges to judge
    symmetrical equivalence of atoms.</li>
  <li><font color="red">BUG FIX:</font> Geometries with collinear atoms are now detected and processed
    correctly.</li>
  <li><font color="red">BUG FIX:</font> Overflow problem during the determination of rotational axes
    has been fixed.</li>
  <li><font color="red">BUG FIX:</font> AUTOSYM now works for Ih and Oh symmetries.</li>
 </ul>

<p>
<b>DFT:</b>
<ul>
  <li>New density functionals, B97-2, HCTC P1/4 and OPTX, have been added.</li>
  <li>A robust algorithm of eliminating linear dependence in basis functions
    has been implemented.</li>
  <li>A new SCF convergence scheme based on fractional occupation numbers has
    been implemented (with keyword SMEAR).</li>
  <li>Charge density fitting calculations has improved performance.
  <li>The default value of the Schwartz screening tolerance has been raised from
    1E-10 to 1E-8 (accCoul = 8).</li>
  <li>Threshold for level shifting has been decreased from 0.05 to 0.01.
  <li>Symmetry can be turned on and off in Lebedev grids via keywords SYMM and
    NOSYMM.</li>
  <li>Spatial symmetry breaking of orbitals for open-shell systems is checked.</li>
  <li><font color="red">BUG FIX:</font> Problems with reusing a quadrature grid have been fixed.</li>
  <li><font color="red">BUG FIX:</font> Restart problem when linear dependence in the basis functions is
    present has been fixed.</li>
  <li><font color="red">BUG FIX:</font> DFT open-shell calculations with the exchange functions xpbe96
    and xperdew91 now give correct gradients.</li>
  <li><font color="red">BUG FIX:</font> Restart calculations now work under NQE or NQS.</li>
  <li><font color="red">BUG FIX:</font> DFT calculations now work when the molecule contains ghost atoms.</li>
  <li><font color="red">BUG FIX:</font> Bug introduced in 4.0.1 which produced nonsense numbers for
    very large SCF and DFT calculations has been fixed.</li>
  <li><font color="red">BUG FIX:</font> Convergence of COSMO for UDFT has been improved.</li>
  <li><font color="red">BUG FIX:</font> Problems with negative electron density and other unstable
    floating-point operations in some density functionals have been fixed.</li>
  <li><font color="red">BUG FIX:</font> LOCK keyword (in VECTOR directive) will now work.</li>
  <li><font color="red">KNOWN PROBLEM:</font> In a sequence of calculations in one input deck (using
    the same geometry and basis set) if the Hamiltonian gets changed (by
    adding relativistic operators or COSMO) in the subsequent calculation
    the vectors are assumed to be converged. This is not correct as the
    Hamiltonian changed. </li>
</ul>
<p>
<b>SCF:</b>
<ul>
  <li><font color="red">BUG FIX:</font> Bug introduced in 4.0.1 which produced nonsense numbers for
    very large SCF and DFT calculations has been fixed.</li>
  <li><font color="red"> KNOWN PROBLEM:</font> In a sequence of calculations in one input deck (using
    the same geometry and basis set) if the Hamiltonian gets changed (by
    adding relativistic operators or COSMO) in the subsequent calculation
    the vectors are assumed to be converged. This is not correct as the
    Hamiltonian changed.</li>
</ul>
<p>
<b>COSMO:</b><br>
By default, induced charges will not be re-scaled (ifscrn = 2).
<ul>
  <li><font color="red">BUG FIX:</font> Make COSMO gradients will now always be computed numerically.</li>
  <li><font color="red">KNOWN PROBLEM:</font> No ECP can be used with COSMO.</li>
  <li><font color="red">KNOWN PROBLEM:</font> No spherical Gaussian basis set can be used with COSMO.</li>
</ul>

<p>
<b>Driver:</b>
<ul>
	<li><font color="red">BUG FIX:</font> Insufficient internal variable errors have been minimized.</li>
</ul>

<p>
<b>Properties: </b>
<ul>
	<li><font color="red">BUG FIX:</font> Segmentation violations in large property calculations have been
    fixed.</li>
    <li><font color="red">BUG FIX:</font> SIGFPE problems on Linux have been fixed.</li>
    <li><font color="red">KNOWN PROBLEM:</font> Electrostatic potential (ESP) not available for UHF.</li>
</ul>

<p>
<b>MP2:</b>
<ul>
    <li>Singlet and triplet pair contributions to MP2 correlation energies are
    now printed separately.</li>
   <li><font color="red">BUG FIX:</font> Problem with numerical gradients for direct MP2 energies has been
    fixed.</li>
</ul>
<p>
<b>MCSCF:</b>
<ul>
	<li><font color="red">BUG FIX:</font> bgj_get_scf_method error has been eliminated.</li>
</ul>
<p>
<b>Hessian and Frequencies:</b>
<ul>
	 <li><font color="red">BUG FIX:</font> ANIMATE directive is now processed correctly.</li>
</ul>

<p>
<b>PSPW:</b>
<ul>
  <li>Improved user interface.</li>
  <li>Conjugate gradient optimization has been improved.</li>
  <li>Pseudopotential library.</li>
  <li>Automated pseudopotential formatting.</li>
  <li>Automated wavefunction initial guess, now with LCAO.</li>
  <li>Automated conversion between small and large plane-wave expansions.</li>
  <li>Fixed atoms in cartesian and SHAKE constraints in Car-Parrinello.</li>
  <li>Polarization through the use of point charges.</li>
  <li>DPLOT available during Car-Parrinello simulations.</li>
  <li><font color="red">BUG FIX:</font>  Ewald sum for irregular shaped unit cells is now correct.</li>
</ul>

<p>
<b>Prepare:</b>
<ul>
  <li>Default force field changed to AMBER99</li>
  <li>New potential of mean force options, e.g. including bias correction,
    constraint contributions, definitions in terms of centers of geometry,
    automatic application of alignment pmf to each equivalent molecules,
    automatic application of xy-plane pmf to all equivalent atoms.</li>
  <li>Repeat option in PDB export, including inversion, randomization.</li>
  <li>Number of database levels increased from 4 to 6.</li>
</ul>

<p>
<b>MD:</b>
<ul>
  <li>Recording to trajectory file of forces, induced dipoles.</li>
  <li>History recorded on restart file.</li>
  <li>System collapse option.</li>
  <li>Additional properties: e.g. radius of gyration, moment of inertia.</li>
 </ul>

<p>
<b>Analysis:</b>
<ul>
  <li>Analysis options for groups of atoms: bond, angle, torsion.</li>
  <li>Automatic rotation option for POV trajectory files.</li>
</ul>

<p>
<b>QM/MM:</b>
<ul>
  <li>New link atom treatment.</li>
  <li>New options for Bq treatment link atom neighbor atoms.</li>
 </ul>

<p>
<b>Integral changes:</b>
<ul>
  <li>Third-order Douglas-Kroll (DK3) integrals have been added.</li>
  <li>Default value for integral screening threshold (tol2e) has been raised from
    1E-10 to 1E-8.</li>
  <li>Texas integral routine will be invoked in DFT.</li>
  <li>Texas integral routine will be invoked for three-center electron-repulsion
    integrals evaluation.</li>
  <li><font color="red">BUG FIX:</font> An error in the transformation from Cartesian to
    spherical  Gaussian basis of integral second derivatives has been fixed.</li>
</ul>

<p>
<b>Effective core potentials:</b>
<ul>
  <li>ECP integral evaluation has been accelerated by virtue of spatial symmetry.</li>
  <li><font color="red">BUG FIX:</font> Wrong numbers of core electrons in LANL2DZ ECP have been
    corrected.</li>
  <li><font color="red">BUG FIX:</font> Unstable floating-point operations have been removed.</li>
</ul>

<p>
<b>Relativistic:</b>
<ul>
  <li>Various levels of third-order Douglas-Kroll have been added.</li>
  <li><font color="red">BUG FIX:</font> Spin-orbit gradient crashes have been fixed.</li>
</ul>

<p>
<b>DPLOT:</b>
<ul>
  <li>DPLOT available during Car-Parrinello simulations.</li>
  <li><font color="red">BUG FIX:</font>  Vectors directive now picks up the vectors correctly.</li>
  <li><font color="red">BUG FIX:</font>  Negative spin densities are now correctly calculated for
    DFT wavefunctions.</li>
</ul>

<p>
<b>PYTHON:</b>
<ul>
  <li>A python script that generates Coulomb fitting basis sets for atoms,
  diatomic hydride and fluoride molecules has been added.</li>
</ul>

<p>
<b>Tests, manuals and miscellaneous script changes:</b>
<ul>
  <li>Updated User's Manual to reflect new and modified functionality in
    NWChem.</li>
  <li>QA tests have been updated to reflect the new functionality.</li>
  <li>The program contrib/hessian/makerestart has been added to create the
    *.fdrst file from the *.hessian and *.fd_ddipole files for numerical
    hessian restarts.</li>
  <li>The amount of memory (in MB) per node that is consumed by the OS may
    now be supplied to the contrib/getmem.nwchem script.  Several small bugs
    in this script have also been fixed.</li>
</ul>

<p>
<b>Tools:</b>
<ul>
  <li><font color="red">BUG FIX:</font> MPICH does not cause segmentation violations with RedHat 7.1.</li>
  <li><font color="red">BUG FIX:</font> Parallel hangs have been fixed.</li>
</ul>

<p>
<b>Installation availability:</b><br>
The current tested platforms and O/S versions are:
<ul>
  <li>IBM SP with P2SC nodes, AIX 4.3.2, and PSSP 3.1.</li>
  <li>IBM SP with silver nodes (SMP nodes with two 604e processors), AIX
    4.3.2, and PSSP 3.1.</li>
  <li>IBM SP with Power 3 nodes (SMP nodes with four processors), AIX 4.3.2
    and PSSP 3.1.</li>
  <li>IBM RS6000 workstation, AIX 4.1 and 4.3.</li>
  <li>Cray T3E, 2.0.4.61 UNICOSMK. </li>
  <li>SGI R8000/10000/12000 IRIX 6.5.</li>
  <li>SUN workstations with Solaris 2.6 and 2.8.</li>
  <li>Compaq DEC alpha workstion (600 MHz EV6), Tru64 V4.0 and V5.0,
    DEC C V5.8-009, Digital Fortran V5.2.</li>
  <li>Linux with Intel x86 cpus. Since there are at least 8 popular
    distributions of the Linux operating system and numerous others in
    existence, including downloading everything and building your own Linux OS,
    it is impossible to test all possible versions of Linux with NWChem.
    NWChem Release 4.0 has been tested on, RedHat 6.x and 7.x, Debian 2.2.1,
    Suse 6.4, TurboLinux 6.04, Mandrake 6.x and 7.x, FreeBSD 4.1.4.
    We have tested NWChem on Linux for the Power PC Macintosh with
    RedHat 6.x and Yellow Dog 2.1.
    These all use the GCC compiler at different levels.
    The Intel Fortran Compiler has been tested on RedHat 6.x and 7.x.
    However, the Portland Group Compiler has
    been tested in a less robust manner.</li>
  <li>Linux with Alpha cpus has been tested with RedHat 6.1 and 6.2.
    Usage of the Compaq Fortran and C compilers is necessary for compiling.</li>
  <li>HP 9000/800 workstations with  HPUX B.11.00. f90 must be used for
    compilation.</li>
  <li>Intel x86 with Windows 98 and NT has been tested with Compaq Visual Fortran
    6.0 and 6.1 with WMPI 1.3 or NT-Mpich.</li>
  <li>A preliminary port is available for Intel IA64 under Linux (with
    Intel compilers) and under HPUX. Not all QA tests have been
    succesful so far.</li>
</ul>
<p>
<hr>
<font size="0">
<center>
<a href="../nwchem_main.html">NWChem</a> |
<a href="../capabilities/nwchem_capab.html">Capabilities</a> |
<a href="../platforms/platforms.html">Platforms</a> |
<a href="../download.html">Download</a> |
<a href="../doc/user/index.html">User's Manual</a> |
<a href="../doc/prog/index.html">Programmer's Manual</a> |
<a href="../release-notes/index.html">Release Notes</a> |
<a href="../support/faq/NWChem_FAQ.html">FAQ</a>
</center>
<br>
<center>
<a href="../support/known_bugs.html">Known Bugs</a> |
<a href="../support/support.html">Support</a> |
<a href="../training/training.html">Tutorial</a> |
<a href="../contributors.html">Contributors</a> |
<a href="../benchmarks/index.html">Benchmarks</a> |
<a href="http://www.emsl.pnl.gov/forms/search_nwchem.html">Search</a> |
<a href="http://www.emsl.pnl.gov/docs/mssg/index.html">Mol Sci. Soft. Group</a> |
<a href="../citation.html">Citation</a>
</center>
</font>

<hr>
Contact: <a href="mailto:ms3distribution@emsl.pnl.gov">NWChem Support</a><br>
Updated: March 8, 2005

</td></tr></table>
</body>
</html>





