diff -Nur nwchem-6.3-ref/QA/doqmtests nwchem-6.3/QA/doqmtests
--- nwchem-6.3-ref/QA/doqmtests	2013-05-17 19:40:51.000000000 -0500
+++ nwchem-6.3/QA/doqmtests	2013-07-31 11:10:55.610554137 -0500
@@ -10,7 +10,7 @@
 ./runtests.unix procs $np auh2o autosym dft_he2+ h2mp2 h2o hess_h2o prop_h2o pyqa
 ./runtests.unix procs $np geom_zmatrix rimp2_ne  scf_feco5 small_intchk tagcheck testtab
 ./runtests.unix procs $np h2o_dk u_sodft cosmo_h2o ch5n_nbo h2s_finite startag
-./runtests.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse dft_s12gh
+./runtests.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse dft_s12gh c4h4_wfn
 ./runtests.unix procs $np dplot dft_meta dft_mpwb1khf dft_m05nh2ch3 prop_uhf_h2o
 ./runtests.unix procs $np et_zn_dimer vectors_rotate sad_ch3hf
 
diff -Nur nwchem-6.3-ref/QA/doqmtests.mpi nwchem-6.3/QA/doqmtests.mpi
--- nwchem-6.3-ref/QA/doqmtests.mpi	2013-05-17 19:40:51.000000000 -0500
+++ nwchem-6.3/QA/doqmtests.mpi	2013-07-31 11:12:01.474547225 -0500
@@ -28,7 +28,7 @@
 ./runtests.mpi.unix procs $np geom_zmatrix rimp2_ne rimp2_he scf_feco5 small_intchk tagcheck testtab
 ./runtests.mpi.unix procs $np h2o_dk u_sodft cosmo_h2o ch5n_nbo h2s_finite startag
 ./runtests.mpi.unix procs $np cosmo_h2o_dft cosmo_h2o_bq be dft_s12gh
-./runtests.mpi.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse bsse_dft_trimer
+./runtests.mpi.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse bsse_dft_trimer c4h4_wfn
 ./runtests.mpi.unix procs $np cosmo_h2cco2 cosmo_h2cco2mg cosmo_h2cco2mg_ecp
 ./runtests.mpi.unix procs $np cosmo_h3co cosmo_h3co_ecp cosmo_h2cco2na cosmo_h3co_gp
 ./runtests.mpi.unix procs $np dplot dft_meta dft_mpwb1khf dft_m05nh2ch3 prop_uhf_h2o
diff -Nur nwchem-6.3-ref/QA/doqmtests.tcg5 nwchem-6.3/QA/doqmtests.tcg5
--- nwchem-6.3-ref/QA/doqmtests.tcg5	2013-05-17 19:40:51.000000000 -0500
+++ nwchem-6.3/QA/doqmtests.tcg5	2013-07-31 11:12:23.973178480 -0500
@@ -10,7 +10,7 @@
 ./runtests.tcg5.unix procs $np auh2o autosym dft_he2+ h2mp2 h2o hess_h2o prop_h2o pyqa
 ./runtests.tcg5.unix procs $np geom_zmatrix rimp2_ne  scf_feco5 small_intchk tagcheck testtab
 ./runtests.tcg5.unix procs $np h2o_dk u_sodft cosmo_h2o ch5n_nbo h2s_finite startag
-./runtests.tcg5.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse
+./runtests.tcg5.unix procs $np cosmo_trichloroethene esp esp_uhf dft_bsse c4h4_wfn
 ./runtests.tcg5.unix procs $np dplot dft_meta prop_uhf_h2o dft_s12gh
 ./runtests.tcg5.unix procs $np et_zn_dimer vectors_rotate sad_ch3hf
 
diff -Nur nwchem-6.3-ref/QA/nqetests nwchem-6.3/QA/nqetests
--- nwchem-6.3-ref/QA/nqetests	2013-05-17 19:40:51.000000000 -0500
+++ nwchem-6.3/QA/nqetests	2013-07-31 11:12:53.103408080 -0500
@@ -43,6 +43,8 @@
 nwdebug neda_nbo.nw -queue debug -accnt mp15 -procs 2 -time 1999
 cd ~/nwchem/QA/tests/ch5n_nbo
 nwdebug ch5n_nbo.nw -queue debug -accnt mp15 -procs 2 -time 1999
+cd ~/nwchem/QA/tests/c4h4_wfn
+nwdebug c4h4_wfn.nw -queue debug -accnt mp15 -procs 2 -time 1999
 #---   small tests that should fail!
 cd ~/nwchem/QA/tests/oh2
 nwdebug oh2.nw -queue debug -accnt mp15 -procs 2 -time 1999
diff -Nur nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4.wfn nwchem-6.3/QA/tests/c4h4_wfn/c4h4.wfn
--- nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4.wfn	1969-12-31 18:00:00.000000000 -0600
+++ nwchem-6.3/QA/tests/c4h4_wfn/c4h4.wfn	2013-07-31 11:17:01.188348105 -0500
@@ -0,0 +1,430 @@
+C4H4 WFN                                                                        
+GAUSSIAN             14 MOL ORBITALS    128 PRIMITIVES        8 NUCLEI
+  C    1    (CENTRE  1)   0.97775600 -0.97775600 -0.97775600  CHARGE =  6.0
+  C    2    (CENTRE  2)  -0.97775600 -0.97775600  0.97775600  CHARGE =  6.0
+  C    3    (CENTRE  3)  -0.97775600  0.97775600 -0.97775600  CHARGE =  6.0
+  C    4    (CENTRE  4)   0.97775600  0.97775600  0.97775600  CHARGE =  6.0
+  H    5    (CENTRE  5)   2.13806500 -2.13806500 -2.13806500  CHARGE =  1.0
+  H    6    (CENTRE  6)  -2.13806500 -2.13806500  2.13806500  CHARGE =  1.0
+  H    7    (CENTRE  7)  -2.13806500  2.13806500 -2.13806500  CHARGE =  1.0
+  H    8    (CENTRE  8)   2.13806500  2.13806500  2.13806500  CHARGE =  1.0
+CENTRE ASSIGNMENTS    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
+CENTRE ASSIGNMENTS    1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  2
+CENTRE ASSIGNMENTS    2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  3  3  3  3
+CENTRE ASSIGNMENTS    3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3  3
+CENTRE ASSIGNMENTS    3  3  3  3  4  4  4  4  4  4  4  4  4  4  4  4  4  4  4  4
+CENTRE ASSIGNMENTS    4  4  4  4  4  4  4  4  4  4  4  4  5  5  5  5  6  6  6  6
+CENTRE ASSIGNMENTS    7  7  7  7  8  8  8  8
+TYPE ASSIGNMENTS      1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  4  4  4  1  2
+TYPE ASSIGNMENTS      3  4  5  8  9  6 10  7  1  1  1  1  1  1  1  1  1  2  2  2
+TYPE ASSIGNMENTS      3  3  3  4  4  4  1  2  3  4  5  8  9  6 10  7  1  1  1  1
+TYPE ASSIGNMENTS      1  1  1  1  1  2  2  2  3  3  3  4  4  4  1  2  3  4  5  8
+TYPE ASSIGNMENTS      9  6 10  7  1  1  1  1  1  1  1  1  1  2  2  2  3  3  3  4
+TYPE ASSIGNMENTS      4  4  1  2  3  4  5  8  9  6 10  7  1  1  1  1  1  1  1  1
+TYPE ASSIGNMENTS      1  1  1  1  1  1  1  1
+EXPONENTS  3.0475249E+03 4.5736951E+02 1.0394869E+02 2.9210155E+01 9.2866630E+00
+EXPONENTS  3.1639270E+00 7.8682724E+00 1.8812885E+00 5.4424930E-01 7.8682724E+00
+EXPONENTS  1.8812885E+00 5.4424930E-01 7.8682724E+00 1.8812885E+00 5.4424930E-01
+EXPONENTS  7.8682724E+00 1.8812885E+00 5.4424930E-01 1.6871440E-01 1.6871440E-01
+EXPONENTS  1.6871440E-01 1.6871440E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01
+EXPONENTS  8.0000000E-01 8.0000000E-01 8.0000000E-01 3.0475249E+03 4.5736951E+02
+EXPONENTS  1.0394869E+02 2.9210155E+01 9.2866630E+00 3.1639270E+00 7.8682724E+00
+EXPONENTS  1.8812885E+00 5.4424930E-01 7.8682724E+00 1.8812885E+00 5.4424930E-01
+EXPONENTS  7.8682724E+00 1.8812885E+00 5.4424930E-01 7.8682724E+00 1.8812885E+00
+EXPONENTS  5.4424930E-01 1.6871440E-01 1.6871440E-01 1.6871440E-01 1.6871440E-01
+EXPONENTS  8.0000000E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01
+EXPONENTS  8.0000000E-01 3.0475249E+03 4.5736951E+02 1.0394869E+02 2.9210155E+01
+EXPONENTS  9.2866630E+00 3.1639270E+00 7.8682724E+00 1.8812885E+00 5.4424930E-01
+EXPONENTS  7.8682724E+00 1.8812885E+00 5.4424930E-01 7.8682724E+00 1.8812885E+00
+EXPONENTS  5.4424930E-01 7.8682724E+00 1.8812885E+00 5.4424930E-01 1.6871440E-01
+EXPONENTS  1.6871440E-01 1.6871440E-01 1.6871440E-01 8.0000000E-01 8.0000000E-01
+EXPONENTS  8.0000000E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01 3.0475249E+03
+EXPONENTS  4.5736951E+02 1.0394869E+02 2.9210155E+01 9.2866630E+00 3.1639270E+00
+EXPONENTS  7.8682724E+00 1.8812885E+00 5.4424930E-01 7.8682724E+00 1.8812885E+00
+EXPONENTS  5.4424930E-01 7.8682724E+00 1.8812885E+00 5.4424930E-01 7.8682724E+00
+EXPONENTS  1.8812885E+00 5.4424930E-01 1.6871440E-01 1.6871440E-01 1.6871440E-01
+EXPONENTS  1.6871440E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01 8.0000000E-01
+EXPONENTS  8.0000000E-01 8.0000000E-01 1.8731137E+01 2.8253937E+00 6.4012170E-01
+EXPONENTS  1.6127780E-01 1.8731137E+01 2.8253937E+00 6.4012170E-01 1.6127780E-01
+EXPONENTS  1.8731137E+01 2.8253937E+00 6.4012170E-01 1.6127780E-01 1.8731137E+01
+EXPONENTS  2.8253937E+00 6.4012170E-01 1.6127780E-01
+MO  1                     OCC NO =   2.00000000 ORB. ENERGY = -11.23803369
+  2.66926632E-01  4.92436672E-01  7.94946549E-01  1.03478430E+00  8.82983403E-01
+  3.04872996E-01 -5.80113800E-03 -2.67374039E-03  7.49744521E-03 -6.17453733E-04
+ -4.73424172E-04 -2.36271844E-04  6.17453733E-04  4.73424172E-04  2.36271845E-04
+  6.17453733E-04  4.73424172E-04  2.36271845E-04 -2.46756323E-04  1.78538975E-04
+ -1.78538975E-04 -1.78538975E-04 -1.31422432E-03 -3.03611640E-06 -3.03611640E-06
+ -1.31422432E-03  3.03611640E-06 -1.31422432E-03  2.66926632E-01  4.92436672E-01
+  7.94946549E-01  1.03478430E+00  8.82983403E-01  3.04872996E-01 -5.80113800E-03
+ -2.67374039E-03  7.49744521E-03  6.17453733E-04  4.73424172E-04  2.36271845E-04
+  6.17453733E-04  4.73424172E-04  2.36271845E-04 -6.17453733E-04 -4.73424172E-04
+ -2.36271845E-04 -2.46756323E-04 -1.78538975E-04 -1.78538975E-04  1.78538975E-04
+ -1.31422432E-03  3.03611641E-06 -3.03611642E-06 -1.31422432E-03 -3.03611641E-06
+ -1.31422432E-03  2.66926632E-01  4.92436672E-01  7.94946549E-01  1.03478430E+00
+  8.82983403E-01  3.04872996E-01 -5.80113800E-03 -2.67374039E-03  7.49744521E-03
+  6.17453733E-04  4.73424172E-04  2.36271845E-04 -6.17453733E-04 -4.73424172E-04
+ -2.36271845E-04  6.17453733E-04  4.73424172E-04  2.36271845E-04 -2.46756323E-04
+ -1.78538975E-04  1.78538975E-04 -1.78538975E-04 -1.31422432E-03 -3.03611641E-06
+  3.03611641E-06 -1.31422432E-03 -3.03611641E-06 -1.31422432E-03  2.66926632E-01
+  4.92436672E-01  7.94946549E-01  1.03478430E+00  8.82983403E-01  3.04872996E-01
+ -5.80113800E-03 -2.67374039E-03  7.49744521E-03 -6.17453733E-04 -4.73424172E-04
+ -2.36271845E-04 -6.17453733E-04 -4.73424172E-04 -2.36271845E-04 -6.17453733E-04
+ -4.73424172E-04 -2.36271845E-04 -2.46756323E-04  1.78538975E-04  1.78538975E-04
+  1.78538975E-04 -1.31422432E-03  3.03611641E-06  3.03611641E-06 -1.31422432E-03
+  3.03611642E-06 -1.31422432E-03 -8.98782929E-05 -1.52450586E-04 -1.73559640E-04
+ -1.23705604E-04 -8.98782929E-05 -1.52450586E-04 -1.73559640E-04 -1.23705604E-04
+ -8.98782929E-05 -1.52450586E-04 -1.73559640E-04 -1.23705604E-04 -8.98782929E-05
+ -1.52450586E-04 -1.73559640E-04 -1.23705604E-04
+MO  2                     OCC NO =   2.00000000 ORB. ENERGY = -11.23646911
+ -1.17721413E-01 -2.17177059E-01 -3.50591585E-01 -4.56366116E-01 -3.89418070E-01
+ -1.34456722E-01  2.44937062E-03  1.12891318E-03 -3.16558958E-03  3.45560243E-04
+  2.64953572E-04  1.32230403E-04 -3.55492883E-04 -2.72569287E-04 -1.36031179E-04
+ -3.45405496E-04 -2.64834922E-04 -1.32171188E-04  7.72987617E-04 -2.27070664E-04
+ -7.25430307E-05  2.31738552E-04  1.28151141E-04  8.52069061E-05  7.31318339E-04
+  6.25917764E-04 -9.51186979E-05  1.20396093E-04  4.60946289E-01  8.50371709E-01
+  1.37276546E+00  1.78693291E+00  1.52479323E+00  5.26474540E-01 -9.59067913E-03
+ -4.42033721E-03  1.23950837E-02  1.36618854E-03  1.04750631E-03  5.22779069E-04
+  1.36525836E-03  1.04679311E-03  5.22423131E-04 -1.36603380E-03 -1.04738766E-03
+ -5.22719854E-04 -3.02668618E-03 -4.93241822E-04 -5.21300283E-04  4.97909709E-04
+ -1.15946604E-03  1.20312010E-03 -1.15345256E-03 -1.11285080E-03 -1.21303189E-03
+ -1.15171100E-03 -1.76501884E-01 -3.25617566E-01 -5.25648423E-01 -6.84238126E-01
+ -5.83861688E-01 -2.01593440E-01  3.67238651E-03  1.69260034E-03 -4.74622679E-03
+ -5.29354847E-04 -4.05875561E-04 -2.02560353E-04  5.19422208E-04  3.98259846E-04
+  1.98759578E-04 -5.20197640E-04 -3.98854398E-04 -1.99056301E-04  1.15895458E-03
+  1.09973085E-06 -3.00713426E-04  2.77322853E-04  7.55924845E-04  2.76659998E-04
+ -2.26992461E-04  2.58158222E-04  8.63192102E-04  2.97018417E-04 -1.66722992E-01
+ -3.07577085E-01 -4.96525454E-01 -6.46328670E-01 -5.51513477E-01 -1.90424379E-01
+  3.46892200E-03  1.59882369E-03 -4.48326735E-03  4.91273454E-04  3.76677175E-04
+  1.87988312E-04  4.90343274E-04  3.75963973E-04  1.87632374E-04  5.00430661E-04
+  3.83698338E-04  1.91492365E-04  1.09474398E-03 -2.65071427E-04 -2.93129888E-04
+  1.11516949E-05  2.75390058E-04 -8.41253196E-04 -1.95141763E-04  2.28774815E-04
+ -2.54721092E-04  7.34296485E-04  2.99002108E-05  5.07164136E-05  5.77388561E-05
+ -1.47901677E-05 -1.17076332E-04 -1.98583605E-04 -2.26080462E-04  5.79119189E-05
+  4.48299370E-05  7.60400534E-05  8.65689309E-05 -2.21751710E-05  4.23461840E-05
+  7.18271384E-05  8.17726751E-05 -2.09465802E-05
+MO  3                     OCC NO =   2.00000000 ORB. ENERGY = -11.23646911
+ -3.12177849E-02 -5.75917883E-02 -9.29711290E-02 -1.21020797E-01 -1.03267275E-01
+ -3.56557138E-02  6.49532852E-04  2.99369231E-04 -8.39462355E-04  8.65535009E-05
+  6.63637084E-05  3.31201420E-05 -9.24708115E-05 -7.09007251E-05 -3.53844313E-05
+ -9.84793236E-05 -7.55076693E-05 -3.76836194E-05  2.04983618E-04 -2.13553902E-04
+  3.50608334E-05 -1.46183289E-04 -2.20767072E-04  4.63490859E-04  7.86371374E-05
+  7.57744196E-05  3.00374998E-04  3.76886405E-04  8.48484170E-03  1.56531672E-02
+  2.52690995E-02  3.28928625E-02  2.80675418E-02  9.69104913E-03 -1.76539862E-04
+ -8.13670972E-05  2.28161775E-04  1.89538402E-05  1.45325967E-05  7.25278437E-06
+  2.55906320E-05  1.96212657E-05  9.79238687E-06 -3.08796629E-05 -2.36765575E-05
+ -1.18162617E-05 -5.57135478E-05 -1.95924487E-04  4.27141567E-06 -1.63812704E-04
+  2.89074542E-04  3.89447691E-04 -5.06777614E-05 -4.35231994E-05  3.74418166E-04
+ -3.08578934E-04  3.88178326E-01  7.16126531E-01  1.15605183E+00  1.50483612E+00
+  1.28407951E+00  4.43361864E-01 -8.07663248E-03 -3.72251419E-03  1.04383156E-02
+  1.14802677E-03  8.80233763E-04  4.39298344E-04 -1.15394408E-03 -8.84770779E-04
+ -4.41562633E-04  1.14865505E-03  8.80715487E-04  4.39538759E-04 -2.54887392E-03
+ -4.90377079E-04  3.11884010E-04 -4.71425298E-04 -8.51820470E-04 -9.02518656E-04
+  1.24128859E-03 -1.14836196E-03 -8.62276450E-04 -8.83306226E-04 -3.65445383E-01
+ -6.74187910E-01 -1.08834980E+00 -1.41670819E+00 -1.20887978E+00 -4.17397199E-01
+  7.60363949E-03  3.50451205E-03 -9.82701506E-03  1.08042711E-03  8.28402651E-04
+  4.13430986E-04  1.08706390E-03  8.33491320E-04  4.15970589E-04  1.08105539E-03
+  8.28884376E-04  4.13671401E-04  2.39960385E-03 -4.72747664E-04 -2.72551761E-04
+ -4.53795883E-04  7.83512999E-04 -8.28475488E-04 -1.21332921E-03  1.11611074E-03
+ -7.88233282E-04  8.14998756E-04  7.92904473E-06  1.34491597E-05  1.53113961E-05
+ -3.92210951E-06 -2.15507569E-06 -3.65541603E-06 -4.16156281E-06  1.06601024E-06
+ -9.85939048E-05 -1.67233913E-04 -1.90389938E-04  4.87695687E-05  9.28199358E-05
+  1.57440169E-04  1.79240105E-04 -4.59134695E-05
+MO  4                     OCC NO =   2.00000000 ORB. ENERGY = -11.23646911
+  4.46236015E-01  8.23233623E-01  1.32895612E+00  1.72990616E+00  1.47613220E+00
+  5.09673050E-01 -9.28460982E-03 -4.27927008E-03  1.19995169E-02 -1.32351491E-03
+ -1.01478689E-03 -5.06449784E-04  1.32048062E-03  1.01246039E-03  5.05288697E-04
+  1.32272143E-03  1.01417849E-03  5.06146154E-04 -2.93009492E-03  4.49573843E-04
+ -5.41101878E-04 -4.73508907E-04 -1.16886069E-03 -1.18279674E-03 -1.03926984E-03
+ -1.01679955E-03  1.23362045E-03 -1.12909590E-03 -3.76296262E-02 -6.94206034E-02
+ -1.12066530E-01 -1.45877338E-01 -1.24477408E-01 -4.29790642E-02  7.82940831E-04
+  3.60856874E-04 -1.01188008E-03 -1.08465322E-04 -8.31642965E-05 -4.15048130E-05
+ -1.18363128E-04 -9.07533036E-05 -4.52922595E-05  1.07671839E-04  8.25559043E-05
+  4.12011827E-05  2.47085338E-04  1.32699271E-04 -1.65863698E-04 -1.56634336E-04
+ -5.89112107E-05  1.48069715E-04  5.36722524E-04  4.37109776E-04 -9.72460050E-05
+ -9.86760028E-05 -1.79232069E-01 -3.30654319E-01 -5.33779316E-01 -6.94822134E-01
+ -5.92893041E-01 -2.04711750E-01  3.72919212E-03  1.71878201E-03 -4.81964290E-03
+ -5.29540458E-04 -4.06017875E-04 -2.02631378E-04  5.26506167E-04  4.03691375E-04
+  2.01470291E-04 -5.37197457E-04 -4.11888774E-04 -2.05561368E-04  1.17688165E-03
+  2.42512076E-04 -3.34040111E-04  1.15420776E-05  3.66572839E-04  8.54407070E-04
+ -1.69614831E-04  2.14511696E-04  3.63965437E-04  7.50297474E-04 -2.29374320E-01
+ -4.23158700E-01 -6.83110270E-01 -8.89206684E-01 -7.58761746E-01 -2.61982236E-01
+  4.77247687E-03  2.19963120E-03 -6.16799390E-03  6.85509132E-04  5.25604715E-04
+  2.62313593E-04  6.75611326E-04  5.18015708E-04  2.58526147E-04  6.77852133E-04
+  5.19733816E-04  2.59383603E-04  1.50612794E-03 -7.43624962E-05 -3.72925465E-04
+ -3.05332494E-04  8.61199063E-04 -4.76459385E-04 -3.32932489E-04  3.65178076E-04
+ -9.66901018E-04  4.77474427E-04 -1.13340051E-04 -1.92246166E-04 -2.18865510E-04
+  5.60637639E-05  9.55759642E-06  1.62114915E-05  1.84562138E-05 -4.72767416E-06
+  4.55233804E-05  7.72162645E-05  8.79080059E-05 -2.25181834E-05  5.82590740E-05
+  9.88184100E-05  1.12501290E-04 -2.88179064E-05
+MO  5                     OCC NO =   2.00000000 ORB. ENERGY =  -1.29659946
+ -5.77276910E-02 -1.06498298E-01 -1.71921507E-01 -2.23790740E-01 -1.90961062E-01
+ -6.59342754E-02 -8.20485327E-02 -3.78161106E-02  1.06040294E-01 -1.06150870E-01
+ -8.13897221E-02 -4.06191760E-02  1.06150870E-01  8.13897221E-02  4.06191760E-02
+  1.06150870E-01  8.13897221E-02  4.06191760E-02  1.91439139E-02 -3.91037086E-04
+  3.91037086E-04  3.91037086E-04  2.58066463E-03 -2.01536974E-02 -2.01536974E-02
+  2.58066463E-03  2.01536974E-02  2.58066463E-03 -5.77276910E-02 -1.06498298E-01
+ -1.71921507E-01 -2.23790740E-01 -1.90961062E-01 -6.59342754E-02 -8.20485327E-02
+ -3.78161106E-02  1.06040294E-01  1.06150870E-01  8.13897221E-02  4.06191760E-02
+  1.06150870E-01  8.13897221E-02  4.06191760E-02 -1.06150870E-01 -8.13897221E-02
+ -4.06191760E-02  1.91439139E-02  3.91037086E-04  3.91037086E-04 -3.91037086E-04
+  2.58066463E-03  2.01536974E-02 -2.01536974E-02  2.58066463E-03 -2.01536974E-02
+  2.58066463E-03 -5.77276910E-02 -1.06498298E-01 -1.71921507E-01 -2.23790740E-01
+ -1.90961062E-01 -6.59342754E-02 -8.20485327E-02 -3.78161106E-02  1.06040294E-01
+  1.06150870E-01  8.13897221E-02  4.06191760E-02 -1.06150870E-01 -8.13897221E-02
+ -4.06191760E-02  1.06150870E-01  8.13897221E-02  4.06191760E-02  1.91439139E-02
+  3.91037086E-04 -3.91037086E-04  3.91037086E-04  2.58066463E-03 -2.01536974E-02
+  2.01536974E-02  2.58066463E-03 -2.01536974E-02  2.58066463E-03 -5.77276910E-02
+ -1.06498298E-01 -1.71921507E-01 -2.23790740E-01 -1.90961062E-01 -6.59342754E-02
+ -8.20485327E-02 -3.78161106E-02  1.06040294E-01 -1.06150870E-01 -8.13897221E-02
+ -4.06191760E-02 -1.06150870E-01 -8.13897221E-02 -4.06191760E-02 -1.06150870E-01
+ -8.13897221E-02 -4.06191760E-02  1.91439139E-02 -3.91037086E-04 -3.91037086E-04
+ -3.91037086E-04  2.58066463E-03  2.01536974E-02  2.01536974E-02  2.58066463E-03
+  2.01536974E-02  2.58066463E-03  4.47760846E-03  7.59487094E-03  8.64649390E-03
+ -1.15334930E-03  4.47760846E-03  7.59487094E-03  8.64649390E-03 -1.15334930E-03
+  4.47760846E-03  7.59487094E-03  8.64649390E-03 -1.15334930E-03  4.47760846E-03
+  7.59487094E-03  8.64649390E-03 -1.15334930E-03
+MO  6                     OCC NO =   2.00000000 ORB. ENERGY =  -0.80539110
+  3.89412458E-02  7.18403306E-02  1.15972725E-01  1.50962044E-01  1.28816198E-01
+  4.44771441E-02  5.62158284E-02  2.59098355E-02 -7.26538643E-02  1.05162675E-01
+  8.06320373E-02  4.02410382E-02  1.29131427E-01  9.90097490E-02  4.94128044E-02
+  9.45576499E-02  7.25007798E-02  3.61829708E-02 -3.08381992E-02  3.67727634E-03
+  3.59139100E-03  2.51878488E-03 -1.56777703E-02  1.87838431E-02  2.37621840E-02
+  5.56590232E-03  9.97424855E-03  2.43106452E-03  2.92020291E-02  5.38730434E-02
+  8.69679135E-02  1.13206393E-01  9.65992297E-02  3.33533976E-02  4.21562336E-02
+  1.94297782E-02 -5.44831121E-02  7.77790353E-02  5.96360074E-02  2.97625476E-02
+  1.33045170E-01  1.02010557E-01  5.09104180E-02  1.21941290E-01  9.34968097E-02
+  4.66614613E-02 -2.31255568E-02  2.10197751E-03  3.81653686E-03  4.09408371E-03
+  2.44598958E-03  1.36828289E-02  2.30331336E-02  7.45702334E-03  1.50752627E-02
+ -1.56628452E-02  1.29292808E-02  2.38524420E-02  3.85052891E-02  5.01224502E-02
+  4.27695815E-02  1.47673109E-02  1.86647914E-02  8.60258913E-03 -2.41225516E-02
+  8.43183025E-02  6.46499007E-02  3.22648318E-02  1.49975800E-01  1.14991886E-01
+  5.73890108E-02  1.05010659E-01  8.05154811E-02  4.01828685E-02 -1.02389055E-02
+  2.47816198E-03  4.79050536E-03  3.12011521E-03  5.60576487E-03  1.68366604E-02
+  1.98793020E-02 -1.56379077E-02  1.38571305E-02  7.48196084E-03 -8.10725557E-02
+ -1.49565816E-01 -2.41445928E-01 -3.14290887E-01 -2.68185009E-01 -9.25978526E-02
+ -1.17036853E-01 -5.39422028E-02  1.51259528E-01  5.69346626E-02  4.36538708E-02
+  2.17863413E-02  1.12200797E-01  8.60284204E-02  4.29342116E-02  7.76270193E-02
+  5.95194512E-02  2.97043779E-02  6.42026615E-02  9.02863152E-04  2.61742250E-03
+  1.54481639E-03  7.62601581E-03  2.19376746E-02  2.69160155E-02  2.61498204E-03
+  1.89581447E-02  5.74981984E-03 -1.93961298E-02 -3.28995052E-02 -3.74549316E-02
+ -7.67514407E-03 -1.45451522E-02 -2.46713296E-02 -2.80874425E-02 -5.75558834E-03
+ -6.43990719E-03 -1.09233008E-02 -1.24357944E-02 -2.54830298E-03  4.03811892E-02
+  6.84941356E-02  7.79781684E-02  1.59790354E-02
+MO  7                     OCC NO =   2.00000000 ORB. ENERGY =  -0.80539110
+ -7.24452551E-02 -1.33649835E-01 -2.15752565E-01 -2.80845760E-01 -2.39646218E-01
+ -8.27440926E-02 -1.04582428E-01 -4.82019669E-02  1.35163311E-01  1.52826774E-01
+  1.17177830E-01  5.84799505E-02 -4.06216153E-02 -3.11460658E-02 -1.55440699E-02
+ -2.70549681E-02 -2.07440253E-02 -1.03527226E-02  5.73705633E-02  3.96967490E-03
+ -4.88656980E-04 -6.77695383E-05 -2.42947979E-03 -1.35106905E-02 -1.54641767E-02
+  7.74427030E-03  3.16208008E-02  8.97437131E-03  3.96237273E-02  7.30993991E-02
+  1.18005255E-01  1.53607794E-01  1.31073821E-01  4.52566473E-02  5.72010630E-02
+  2.63639294E-02 -7.39271908E-02  1.66016232E-01  1.27290667E-01  6.35269646E-02
+ -8.56569715E-02 -6.56763068E-02 -3.27770804E-02 -4.02444266E-02 -3.08568616E-02
+ -1.53997367E-02 -3.13786673E-02  4.72842496E-03 -3.07940620E-03 -8.26519601E-04
+  8.80262898E-03 -1.10537631E-02 -7.07500738E-03 -1.40168235E-02  2.91638734E-02
+ -2.60122212E-03  4.60091053E-02  8.48793936E-02  1.37021844E-01  1.78361745E-01
+  1.52196414E-01  5.25497723E-02  6.64190349E-02  3.06124861E-02 -8.58405842E-02
+  1.63450243E-01  1.25323230E-01  6.25450758E-02 -5.12450849E-02 -3.92914653E-02
+ -1.96091951E-02 -7.46563132E-02 -5.72417031E-02 -2.85676220E-02 -3.64353508E-02
+  4.58081130E-03 -1.09979338E-03 -2.80613242E-03  7.56274258E-03 -4.64352980E-03
+ -1.34852407E-02 -2.61100752E-03  2.96418649E-02 -1.40266089E-02 -1.31875775E-02
+ -2.43289578E-02 -3.92745344E-02 -5.11237790E-02 -4.36240174E-02 -1.50623271E-02
+ -1.90376701E-02 -8.77444866E-03  2.46044636E-02  1.76639702E-01  1.35436066E-01
+  6.75920899E-02 -7.50335019E-02 -5.75309074E-02 -2.87119552E-02 -6.14668547E-02
+ -4.71288669E-02 -2.35206079E-02  1.04434548E-02  5.33956137E-03 -2.46826980E-03
+ -2.04738236E-03 -1.39358918E-02 -7.10045719E-03 -9.05394332E-03  8.88356071E-03
+  2.71849375E-02  7.65345970E-03  3.60840426E-02  6.12053621E-02  6.96801557E-02
+  1.42786333E-02 -1.97360650E-02 -3.34760996E-02 -3.81113640E-02 -7.80965810E-03
+ -2.29165390E-02 -3.88707851E-02 -4.42530240E-02 -9.06818731E-03  6.56856142E-03
+  1.11415227E-02  1.26842324E-02  2.59921209E-03
+MO  8                     OCC NO =   2.00000000 ORB. ENERGY =  -0.80539110
+ -8.19102718E-03 -1.51111267E-02 -2.43940769E-02 -3.17538429E-02 -2.70956142E-02
+ -9.35546586E-03 -1.18246186E-02 -5.44995832E-03  1.52822480E-02 -5.49491586E-03
+ -4.21315129E-03 -2.10265780E-03  1.26965995E-01  9.73494336E-02  4.85841907E-02
+ -1.57392137E-01 -1.20678260E-01 -6.02269101E-02  6.48660623E-03 -2.57710776E-04
+  4.02619175E-03 -4.79564646E-03  1.79027708E-03 -2.37502992E-02  1.71949436E-02
+  1.28041772E-02  2.95897285E-04 -1.29788493E-02  6.64005292E-02  1.22498289E-01
+  1.97750487E-01  2.57412401E-01  2.19650489E-01  7.58400467E-02  9.58562232E-02
+  4.41800653E-02 -1.23885483E-01 -2.88866305E-02 -2.21484273E-02 -1.10536176E-02
+  9.69910885E-02  7.43665854E-02  3.71141386E-02 -1.34000422E-01 -1.02742984E-01
+ -5.12759503E-02 -5.25836476E-02 -1.60336609E-03  2.30182509E-03 -3.44999114E-03
+ -1.30931586E-02 -2.81076991E-02  2.27786580E-02 -1.67970425E-03  4.65329712E-03
+  1.67596777E-03 -6.74375598E-02 -1.24411443E-01 -2.00838916E-01 -2.61432618E-01
+ -2.23080948E-01 -7.70245019E-02 -9.73532873E-02 -4.48700611E-02  1.25820302E-01
+  2.48967258E-02  1.90892226E-02  9.52686008E-03  9.65743537E-02  7.40470597E-02
+  3.69546728E-02 -1.33583687E-01 -1.02423458E-01 -5.11164846E-02  5.34048888E-02
+  1.49062938E-03  2.27785159E-03 -3.42601764E-03  1.28949707E-02 -2.81853283E-02
+  2.28562872E-02  1.88107060E-03 -5.36544633E-03 -1.47460142E-03  9.22805785E-03
+  1.70242814E-02  2.74825059E-02  3.57740602E-02  3.05260733E-02  1.05399211E-02
+  1.33216826E-02  6.13995407E-03 -1.72170676E-02  1.50501116E-03  1.15394664E-03
+  5.75900256E-04  1.27382730E-01  9.76689593E-02  4.87436564E-02 -1.56975402E-01
+ -1.20358734E-01 -6.00674444E-02 -7.30784751E-03  1.44974069E-04  4.05016525E-03
+ -4.77167295E-03 -1.59208917E-03 -2.38279284E-02  1.71173144E-02 -1.30055435E-02
+ -1.00804650E-03  1.27774830E-02  4.07984448E-03  6.92018799E-03  7.87839104E-03
+  1.61441455E-03 -3.30732430E-02 -5.60984763E-02 -6.38661456E-02 -1.30872451E-02
+  3.35897745E-02  5.69746115E-02  6.48635947E-02  1.32916391E-02 -4.59637601E-03
+ -7.79632318E-03 -8.87584020E-03 -1.81880862E-03
+MO  9                     OCC NO =   2.00000000 ORB. ENERGY =  -0.70965431
+ -1.67830575E-02 -3.09620397E-02 -4.99823997E-02 -6.50622394E-02 -5.55177319E-02
+ -1.91689416E-02 -2.31642561E-02 -1.06763892E-02  2.99377020E-02  1.74495643E-01
+  1.33792138E-01  6.67716546E-02 -1.74495643E-01 -1.33792138E-01 -6.67716546E-02
+ -1.74495643E-01 -1.33792138E-01 -6.67716546E-02  1.90117863E-02  6.54812776E-03
+ -6.54812776E-03 -6.54812776E-03  3.08383626E-03  2.32510395E-03  2.32510395E-03
+  3.08383626E-03 -2.32510395E-03  3.08383626E-03 -1.67830575E-02 -3.09620397E-02
+ -4.99823997E-02 -6.50622394E-02 -5.55177319E-02 -1.91689416E-02 -2.31642561E-02
+ -1.06763892E-02  2.99377020E-02 -1.74495643E-01 -1.33792138E-01 -6.67716546E-02
+ -1.74495643E-01 -1.33792138E-01 -6.67716546E-02  1.74495643E-01  1.33792138E-01
+  6.67716546E-02  1.90117863E-02 -6.54812776E-03 -6.54812776E-03  6.54812776E-03
+  3.08383626E-03 -2.32510395E-03  2.32510395E-03  3.08383626E-03  2.32510395E-03
+  3.08383626E-03 -1.67830575E-02 -3.09620397E-02 -4.99823997E-02 -6.50622394E-02
+ -5.55177319E-02 -1.91689416E-02 -2.31642561E-02 -1.06763892E-02  2.99377020E-02
+ -1.74495643E-01 -1.33792138E-01 -6.67716546E-02  1.74495643E-01  1.33792138E-01
+  6.67716546E-02 -1.74495643E-01 -1.33792138E-01 -6.67716546E-02  1.90117863E-02
+ -6.54812776E-03  6.54812776E-03 -6.54812776E-03  3.08383626E-03  2.32510395E-03
+ -2.32510395E-03  3.08383626E-03  2.32510395E-03  3.08383626E-03 -1.67830575E-02
+ -3.09620397E-02 -4.99823997E-02 -6.50622394E-02 -5.55177319E-02 -1.91689416E-02
+ -2.31642561E-02 -1.06763892E-02  2.99377020E-02  1.74495643E-01  1.33792138E-01
+  6.67716546E-02  1.74495643E-01  1.33792138E-01  6.67716546E-02  1.74495643E-01
+  1.33792138E-01  6.67716546E-02  1.90117863E-02  6.54812776E-03  6.54812776E-03
+  6.54812776E-03  3.08383626E-03 -2.32510395E-03 -2.32510395E-03  3.08383626E-03
+ -2.32510395E-03  3.08383626E-03  3.19400068E-02  5.41762935E-02  6.16778079E-02
+  1.49627299E-02  3.19400068E-02  5.41762935E-02  6.16778079E-02  1.49627299E-02
+  3.19400068E-02  5.41762935E-02  6.16778079E-02  1.49627299E-02  3.19400068E-02
+  5.41762935E-02  6.16778079E-02  1.49627299E-02
+MO 10                     OCC NO =   2.00000000 ORB. ENERGY =  -0.53407416
+ -3.39085712E-03 -6.25558560E-03 -1.00984684E-02 -1.31452066E-02 -1.12168296E-02
+ -3.87290230E-03 -5.17840442E-03 -2.38672293E-03  6.69261848E-03 -3.02280950E-01
+ -2.31769768E-01 -1.15669359E-01  1.61226605E-01  1.23618286E-01  6.16941892E-02
+  2.12325639E-01  1.62797768E-01  8.12474971E-02  1.82246365E-02 -2.02441908E-02
+  1.30905500E-02  1.56820627E-02  8.10228643E-03  2.22432157E-02  1.82342574E-02
+ -5.72741106E-03 -2.93006307E-02 -7.17397491E-04  3.71109053E-04  6.84636469E-04
+  1.10521704E-03  1.43866432E-03  1.22761499E-03  4.23866018E-04  5.66745425E-04
+  2.61212565E-04 -7.32467107E-04  6.81906301E-02  5.22842293E-02  2.60934951E-02
+ -3.00302476E-01 -2.30252800E-01 -1.14912286E-01 -1.58145941E-01 -1.21256229E-01
+ -6.05153571E-02 -1.99457758E-03  2.92052860E-03 -1.57677816E-02 -7.48265668E-03
+  9.04262836E-03 -1.17960139E-02 -2.41714094E-02 -2.70863417E-02  4.73859892E-03
+  1.78623123E-02  9.76768873E-04  1.80198135E-03  2.90896056E-03  3.78660267E-03
+  3.23111522E-03  1.11562660E-03  1.49168899E-03  6.87518400E-04 -1.92787286E-03
+ -6.11349903E-03 -4.68744144E-03 -2.33936183E-03 -1.34940845E-01 -1.03464040E-01
+ -5.16358081E-02 -3.23507571E-01 -2.48044989E-01 -1.23791835E-01 -5.24978111E-03
+ -1.72553441E-03 -5.42810645E-03 -1.78223318E-02  5.60393553E-03 -2.69895748E-02
+ -8.97784850E-03  1.94336330E-02 -2.08852480E-03 -2.55150209E-02  2.04297919E-03
+  3.76896778E-03  6.08429083E-03  7.91993959E-03  6.75809943E-03  2.33340968E-03
+  3.11997000E-03  1.43799196E-03 -4.03227851E-03  3.64358081E-01  2.79366556E-01
+  1.39423492E-01 -4.13502548E-03 -3.17047402E-03 -1.58228876E-03  4.69640083E-02
+  3.60090086E-02  1.79710192E-02 -1.09802778E-02  2.14391850E-02  2.75087484E-03
+  5.34238762E-03 -2.27488503E-02  7.04965475E-03  3.04069646E-03  1.33801197E-02
+  3.19507048E-02  8.37010615E-03 -4.19639223E-02 -7.11787502E-02 -8.10345079E-02
+ -2.54273219E-02  4.59270058E-03  7.79008895E-03  8.86874275E-03  2.78286847E-03
+  1.20881098E-02  2.05037208E-02  2.33427662E-02  7.32458364E-03  2.52831119E-02
+  4.28849405E-02  4.88229990E-02  1.53198698E-02
+MO 11                     OCC NO =   2.00000000 ORB. ENERGY =  -0.53407416
+  2.85779394E-04  5.27216984E-04  8.51092832E-04  1.10787009E-03  9.45347641E-04
+  3.26405872E-04  4.36432803E-04  2.01151570E-04 -5.64049852E-04 -1.47443774E-01
+ -1.13050489E-01 -5.64201178E-02  9.40148749E-02  7.20846145E-02  3.59752751E-02
+ -2.98417463E-01 -2.28807492E-01 -1.14190976E-01 -1.53596138E-03 -7.06354651E-03
+  4.35387348E-03 -1.55485267E-02  1.62710987E-02 -2.38829699E-02  6.90518314E-03
+  1.10326531E-02 -1.10969302E-02 -2.74434430E-02  1.24410513E-03  2.29517372E-03
+  3.70512704E-03  4.82297496E-03  4.11545366E-03  1.42096746E-03  1.89995606E-03
+  8.75688400E-04 -2.45552104E-03 -3.35134510E-01 -2.56959784E-01 -1.28240943E-01
+ -2.35553470E-02 -1.80607389E-02 -9.01357462E-03 -1.10726727E-01 -8.48981973E-02
+ -4.23701510E-02 -6.68661729E-03 -1.87994083E-02 -2.99751688E-03 -3.81266490E-03
+ -2.49571676E-02 -6.63779264E-03 -3.89726432E-03  5.59166506E-03 -2.83421075E-02
+  1.87573741E-02 -3.40726459E-03 -6.28585474E-03 -1.01473323E-02 -1.32088128E-02
+ -1.12711049E-02 -3.89164227E-03 -5.20346137E-03 -2.39827166E-03  6.72500231E-03
+  2.35509217E-01  1.80573458E-01  9.01188123E-02 -2.88938115E-01 -2.21539333E-01
+ -1.10563655E-01  1.54656042E-01  1.18580397E-01  5.91799294E-02  1.83128208E-02
+  1.68816063E-02 -1.95912793E-02  1.27810975E-02  1.45143862E-03  1.77457916E-02
+ -2.82808486E-02  6.68988419E-03  2.40891015E-02 -6.47582483E-03  1.87738006E-03
+  3.46346404E-03  5.59111240E-03  7.27796775E-03  6.21030365E-03  2.14426893E-03
+  2.86707251E-03  1.32143169E-03 -3.70543142E-03  4.78184806E-02  3.66641635E-02
+  1.82979874E-02  3.59397643E-01  2.75563208E-01  1.37525356E-01 -3.30346943E-02
+ -2.53288983E-02 -1.26408956E-02 -1.00902421E-02  5.14574451E-03  2.09476359E-02
+  1.04523575E-03  7.23463031E-03  5.00614372E-04  3.12887674E-02 -2.33142024E-02
+  6.84392425E-03  1.51618938E-02  3.53669408E-03  5.99890217E-03  6.82953949E-03
+  2.14299937E-03  1.53965588E-02  2.61154762E-02  2.97315527E-02  9.32928184E-03
+ -4.21669748E-02 -7.15231656E-02 -8.14266127E-02 -2.55503581E-02  2.32337218E-02
+  3.94087872E-02  4.48655205E-02  1.40780769E-02
+MO 12                     OCC NO =   2.00000000 ORB. ENERGY =  -0.53407416
+  9.96506220E-04  1.83839358E-03  2.96774126E-03  3.86311769E-03  3.29640563E-03
+  1.13816982E-03  1.52183122E-03  7.01410929E-04 -1.96682895E-03 -1.48088633E-01
+ -1.13544926E-01 -5.66668766E-02 -3.16561001E-01 -2.42718801E-01 -1.21133694E-01
+ -3.01417163E-02 -2.31107472E-02 -1.15338827E-02 -5.35586225E-03 -6.06630060E-03
+ -1.74986354E-02 -2.97273973E-03  2.08480595E-02 -4.00616140E-03 -2.64770944E-02
+ -2.47085938E-02 -9.97684342E-03  3.37343421E-03 -3.29955861E-03 -6.08715454E-03
+ -9.82656810E-03 -1.27912731E-02 -1.09148175E-02 -3.76862477E-03 -5.03897636E-03
+ -2.32246063E-03  6.51242035E-03  1.34456612E-01  1.03092761E-01  5.14505136E-02
+  2.10492875E-01  1.61392522E-01  8.05461807E-02 -3.12686961E-01 -2.39748434E-01
+ -1.19651273E-01  1.77339399E-02  1.16005912E-02  1.54568079E-02 -2.06396315E-02
+ -7.77225447E-03 -2.99666479E-02  2.19490437E-02 -3.17265906E-04  1.59836431E-02
+  9.70237082E-03  9.52737252E-05  1.75764688E-04  2.83739088E-04  3.69344020E-04
+  3.15161951E-04  1.08817864E-04  1.45498870E-04  6.70603261E-05 -1.88044105E-04
+ -2.82031410E-01 -2.16243711E-01 -1.07920769E-01 -1.82618224E-01 -1.40020016E-01
+ -6.98798021E-02  8.04241384E-02  6.16641039E-02  3.07747099E-02 -5.12061980E-04
+ -1.44414284E-02 -9.12350759E-03  3.94068398E-03 -2.70467468E-02  6.15271912E-03
+ -1.41703233E-02  1.85099065E-02 -2.22836145E-02  8.49026978E-03  2.20777866E-03
+  4.07299627E-03  6.57508775E-03  8.55881140E-03  7.30324996E-03  2.52163708E-03
+  3.37164628E-03  1.55398938E-03 -4.35754730E-03  5.13834997E-04  3.93975929E-04
+  1.96621603E-04  7.65500986E-02  5.86937371E-02  2.92922887E-02  3.62969383E-01
+  2.78301791E-01  1.38892100E-01 -1.18660156E-02  3.22546336E-03  7.08168008E-03
+  2.16075758E-02  1.39709418E-02  3.21132056E-02  9.64227265E-03  6.51595325E-03
+  3.67687200E-03 -2.15660748E-02  1.23323715E-02  2.09180348E-02  2.38144482E-02
+  7.47258984E-03 -4.08340476E-02 -6.92622690E-02 -7.88526613E-02 -2.47426937E-02
+  1.17907038E-03  1.99992640E-03  2.27684599E-03  7.14437559E-04  2.73226057E-02
+  4.63443078E-02  5.27613672E-02  1.65556663E-02
+MO 13                     OCC NO =   2.00000000 ORB. ENERGY =  -0.33172906
+ -5.95266094E-16 -1.09817013E-15 -1.77278949E-15 -2.30764538E-15 -1.96911817E-15
+ -6.79889286E-16 -3.84752780E-16 -1.77332284E-16  4.97258105E-16  3.04539863E-01
+  2.33501759E-01  1.16533744E-01  4.35537611E-02  3.33942483E-02  1.66660706E-02
+  2.60986102E-01  2.00107510E-01  9.98676734E-02  2.53511227E-15  2.85714682E-02
+  4.08614783E-03  2.44853204E-02  3.57953063E-03  3.21342479E-02  5.36261259E-03
+ -5.11926486E-04  3.74968605E-02 -3.06760415E-03  3.46477541E-16  6.39195295E-16
+  1.03186079E-15  1.34317628E-15  1.14613486E-15  3.95732884E-16  4.09765594E-15
+  1.88860672E-15 -5.29584900E-15 -3.04539863E-01 -2.33501759E-01 -1.16533744E-01
+  4.35537611E-02  3.33942483E-02  1.66660706E-02 -2.60986102E-01 -2.00107510E-01
+ -9.98676734E-02  1.11456960E-14 -2.85714682E-02  4.08614783E-03 -2.44853204E-02
+  3.57953063E-03 -3.21342479E-02  5.36261259E-03 -5.11926486E-04 -3.74968605E-02
+ -3.06760415E-03  2.50283804E-16  4.61733333E-16  7.45381773E-16  9.70265685E-16
+  8.27929544E-16  2.85864218E-16 -3.96127572E-17 -1.82574917E-17  5.11958992E-17
+ -3.04539863E-01 -2.33501759E-01 -1.16533744E-01 -4.35537611E-02 -3.33942483E-02
+ -1.66660706E-02  2.60986102E-01  2.00107510E-01  9.98676734E-02  1.49196516E-15
+ -2.85714682E-02 -4.08614783E-03  2.44853204E-02  3.57953063E-03  3.21342479E-02
+ -5.36261259E-03 -5.11926486E-04 -3.74968605E-02 -3.06760415E-03  4.24156283E-16
+  7.82500071E-16  1.26319945E-15  1.64431050E-15  1.40309326E-15  4.84454458E-16
+ -3.91166485E-15 -1.80288356E-15  5.05547238E-15  3.04539863E-01  2.33501759E-01
+  1.16533744E-01 -4.35537611E-02 -3.33942483E-02 -1.66660706E-02 -2.60986102E-01
+ -2.00107510E-01 -9.98676734E-02 -1.09116667E-14  2.85714682E-02 -4.08614783E-03
+ -2.44853204E-02  3.57953063E-03 -3.21342479E-02 -5.36261259E-03 -5.11926486E-04
+  3.74968605E-02 -3.06760415E-03 -1.62290459E-15 -2.75275317E-15 -3.13391283E-15
+ -4.57927378E-15  9.06772585E-16  1.53805783E-15  1.75102484E-15  3.38133971E-15
+ -1.32104496E-16 -2.24074214E-16 -2.55100625E-16 -3.98361455E-16 -1.25170073E-16
+ -2.12312121E-16 -2.41709895E-16 -5.01510768E-15
+MO 14                     OCC NO =   2.00000000 ORB. ENERGY =  -0.33172906
+ -8.48118646E-16 -1.56464239E-15 -2.52582137E-15 -3.28786923E-15 -2.80554504E-15
+ -9.68687426E-16  5.25927503E-15  2.42399614E-15 -6.79713642E-15 -1.25534621E-01
+ -9.62519467E-02 -4.80364678E-02 -3.26506568E-01 -2.50344428E-01 -1.24939417E-01
+  2.00971948E-01  1.54092482E-01  7.69029488E-02  1.90033350E-14 -1.17774678E-02
+ -3.06323512E-02  1.88548834E-02 -1.47552119E-03  2.47449283E-02 -4.02015392E-02
+  3.83772505E-03 -1.54566109E-02 -2.36220387E-03 -6.42803945E-16 -1.18586981E-15
+ -1.91436416E-15 -2.49193356E-15 -2.12637162E-15 -7.34185131E-16  3.49066408E-15
+  1.60884460E-15 -4.51136702E-15  1.25534621E-01  9.62519467E-02  4.80364678E-02
+ -3.26506568E-01 -2.50344428E-01 -1.24939417E-01 -2.00971948E-01 -1.54092482E-01
+ -7.69029488E-02  1.29480624E-14  1.17774678E-02 -3.06323512E-02 -1.88548834E-02
+ -1.47552119E-03 -2.47449283E-02 -4.02015392E-02  3.83772505E-03  1.54566109E-02
+ -2.36220387E-03  3.94437325E-16  7.27673376E-16  1.17469204E-15  1.52910015E-15
+  1.30478405E-15  4.50510644E-16 -7.19813874E-15 -3.31761705E-15  9.30294208E-15
+  1.25534621E-01  9.62519467E-02  4.80364678E-02  3.26506568E-01  2.50344428E-01
+  1.24939417E-01  2.00971948E-01  1.54092482E-01  7.69029488E-02 -2.03545312E-14
+  1.17774678E-02  3.06323512E-02  1.88548834E-02 -1.47552119E-03  2.47449283E-02
+  4.02015392E-02  3.83772505E-03  1.54566109E-02 -2.36220387E-03  1.16392529E-15
+  2.14725482E-15  3.46633974E-15  4.51214482E-15  3.85022171E-15  1.32938923E-15
+ -2.37553720E-16 -1.09488341E-16  3.07016658E-16 -1.25534621E-01 -9.62519467E-02
+ -4.80364678E-02  3.26506568E-01  2.50344428E-01  1.24939417E-01 -2.00971948E-01
+ -1.54092482E-01 -7.69029488E-02 -5.94407309E-15 -1.17774678E-02  3.06323512E-02
+ -1.88548834E-02 -1.47552119E-03 -2.47449283E-02  4.02015392E-02  3.83772505E-03
+ -1.54566109E-02 -2.36220387E-03  8.67052228E-16  1.47068459E-15  1.67432277E-15
+  4.40388464E-15  1.02274326E-15  1.73476603E-15  1.97497021E-15  3.23487916E-15
+ -1.40335091E-15 -2.38034861E-15 -2.70994331E-15 -8.37005403E-15 -7.23912551E-16
+ -1.22789262E-15 -1.39791264E-15 -4.81356672E-15
+END DATA
+RHF      ENERGY =     -153.5978827607   VIRIAL(-V/T)  =   2.00054063
diff -Nur nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4_wfn.nw nwchem-6.3/QA/tests/c4h4_wfn/c4h4_wfn.nw
--- nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4_wfn.nw	1969-12-31 18:00:00.000000000 -0600
+++ nwchem-6.3/QA/tests/c4h4_wfn/c4h4_wfn.nw	2013-07-31 11:17:01.188348105 -0500
@@ -0,0 +1,48 @@
+echo
+start c4h4
+title "C4H4 WFN"
+
+geometry nocenter units bohr
+symmetry c1
+C 0.97775600 -0.97775600 -0.97775600
+C -0.97775600 -0.97775600  0.97775600
+C -0.97775600  0.97775600 -0.97775600
+C 0.97775600  0.97775600  0.97775600
+H 2.13806500 -2.13806500 -2.13806500
+H -2.13806500 -2.13806500  2.13806500
+H -2.13806500  2.13806500 -2.13806500
+H 2.13806500  2.13806500  2.13806500
+end
+
+BASIS "ao basis" PRINT
+#BASIS SET: (4s) -> [2s]
+H    S
+     18.7311370              0.03349460       
+      2.8253937              0.23472695       
+      0.6401217              0.81375733       
+H    S
+      0.1612778              1.00000000       
+C    S
+   3047.5249000              0.0018347        
+    457.3695100              0.0140373        
+    103.9486900              0.0688426        
+     29.2101550              0.2321844        
+      9.2866630              0.4679413        
+      3.1639270              0.3623120        
+C    SP
+      7.8682724             -0.1193324              0.0689991        
+      1.8812885             -0.1608542              0.3164240        
+      0.5442493              1.1434564              0.7443083        
+	C    SP
+      0.1687144              1.0000000              1.0000000        
+C    D
+      0.8000000              1.0000000        
+END
+scf
+ singlet
+ rhf
+end
+property 
+aimfile
+end
+task scf property
diff -Nur nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4_wfn.out nwchem-6.3/QA/tests/c4h4_wfn/c4h4_wfn.out
--- nwchem-6.3-ref/QA/tests/c4h4_wfn/c4h4_wfn.out	1969-12-31 18:00:00.000000000 -0600
+++ nwchem-6.3/QA/tests/c4h4_wfn/c4h4_wfn.out	2013-07-31 11:17:01.188348105 -0500
@@ -0,0 +1,828 @@
+ argument  1 = c4h4_wfn.nw
+
+
+
+============================== echo of input deck ==============================
+echo
+start c4h4
+title "C4H4 WFN"
+
+geometry nocenter units bohr
+symmetry c1
+C 0.97775600 -0.97775600 -0.97775600
+C -0.97775600 -0.97775600  0.97775600
+C -0.97775600  0.97775600 -0.97775600
+C 0.97775600  0.97775600  0.97775600
+H 2.13806500 -2.13806500 -2.13806500
+H -2.13806500 -2.13806500  2.13806500
+H -2.13806500  2.13806500 -2.13806500
+H 2.13806500  2.13806500  2.13806500
+end
+
+BASIS "ao basis" PRINT
+#BASIS SET: (4s) -> [2s]
+H    S
+     18.7311370              0.03349460
+      2.8253937              0.23472695
+      0.6401217              0.81375733
+H    S
+      0.1612778              1.00000000
+C    S
+   3047.5249000              0.0018347
+    457.3695100              0.0140373
+    103.9486900              0.0688426
+     29.2101550              0.2321844
+      9.2866630              0.4679413
+      3.1639270              0.3623120
+C    SP
+      7.8682724             -0.1193324              0.0689991
+      1.8812885             -0.1608542              0.3164240
+      0.5442493              1.1434564              0.7443083
+	C    SP
+      0.1687144              1.0000000              1.0000000
+C    D
+      0.8000000              1.0000000
+END
+scf
+ singlet
+ rhf
+end
+property
+aimfile
+end
+task scf property
+================================================================================
+
+
+                                         
+                                         
+
+
+              Northwest Computational Chemistry Package (NWChem) 6.1
+              ------------------------------------------------------
+
+
+                    Environmental Molecular Sciences Laboratory
+                       Pacific Northwest National Laboratory
+                                Richland, WA 99352
+
+                              Copyright (c) 1994-2010
+                       Pacific Northwest National Laboratory
+                            Battelle Memorial Institute
+
+             NWChem is an open-source computational chemistry package
+                        distributed under the terms of the
+                      Educational Community License (ECL) 2.0
+             A copy of the license is included with this distribution
+                              in the LICENSE.TXT file
+
+                                  ACKNOWLEDGMENT
+                                  --------------
+
+            This software and its documentation were developed at the
+            EMSL at Pacific Northwest National Laboratory, a multiprogram
+            national laboratory, operated for the U.S. Department of Energy
+            by Battelle under Contract Number DE-AC05-76RL01830. Support
+            for this work was provided by the Department of Energy Office
+            of Biological and Environmental Research, Office of Basic
+            Energy Sciences, and the Office of Advanced Scientific Computing.
+
+
+           Job information
+           ---------------
+
+    hostname      = eaves
+    program       = /sandbox/vama/soft/chem/nwchem/waim/nwchem-6.1/bin/LINUX64/nwchem
+    date          = Wed Jul 31 11:16:22 2013
+
+    compiled      = Wed_Jul_31_11:02:21_2013
+    source        = /homes/vama/soft/chem/nwchem/waim/nwchem-6.1
+    nwchem branch = 6.1
+    input         = c4h4_wfn.nw
+    prefix        = c4h4.
+    data base     = ./c4h4.db
+    status        = startup
+    nproc         =        1
+    time left     =     -1s
+
+
+
+           Memory information
+           ------------------
+
+    heap     =   13107201 doubles =    100.0 Mbytes
+    stack    =   13107201 doubles =    100.0 Mbytes
+    global   =   26214400 doubles =    200.0 Mbytes (distinct from heap & stack)
+    total    =   52428802 doubles =    400.0 Mbytes
+    verify   = yes
+    hardfail = no 
+
+
+           Directory information
+           ---------------------
+
+  0 permanent = .
+  0 scratch   = .
+
+
+
+
+                                NWChem Input Module
+                                -------------------
+
+
+                                     C4H4 WFN
+                                     --------
+ Turning off AUTOSYM since
+ SYMMETRY directive was detected!
+
+
+          ------
+          auto-z
+          ------
+
+
+                             Geometry "geometry" -> ""
+                             -------------------------
+
+ Output coordinates in a.u. (scale by  1.000000000 to convert to a.u.)
+
+  No.       Tag          Charge          X              Y              Z
+ ---- ---------------- ---------- -------------- -------------- --------------
+    1 C                    6.0000     0.97775600    -0.97775600    -0.97775600
+    2 C                    6.0000    -0.97775600    -0.97775600     0.97775600
+    3 C                    6.0000    -0.97775600     0.97775600    -0.97775600
+    4 C                    6.0000     0.97775600     0.97775600     0.97775600
+    5 H                    1.0000     2.13806500    -2.13806500    -2.13806500
+    6 H                    1.0000    -2.13806500    -2.13806500     2.13806500
+    7 H                    1.0000    -2.13806500     2.13806500    -2.13806500
+    8 H                    1.0000     2.13806500     2.13806500     2.13806500
+
+      Atomic Mass 
+      ----------- 
+
+      C                 12.000000
+      H                  1.007825
+
+
+ Effective nuclear repulsion energy (a.u.)     106.8401681452
+
+            Nuclear Dipole moment (a.u.) 
+            ----------------------------
+        X                 Y               Z
+ ---------------- ---------------- ----------------
+     0.0000000000     0.0000000000     0.0000000000
+
+
+
+                                Z-matrix (autoz)
+                                -------- 
+
+ Units are Angstrom for bonds and degrees for angles
+
+      Type          Name      I     J     K     L     M      Value
+      ----------- --------  ----- ----- ----- ----- ----- ----------
+    1 Stretch                  1     2                       1.46345
+    2 Stretch                  1     3                       1.46345
+    3 Stretch                  1     4                       1.46345
+    4 Stretch                  1     5                       1.06349
+    5 Stretch                  2     3                       1.46345
+    6 Stretch                  2     4                       1.46345
+    7 Stretch                  2     6                       1.06349
+    8 Stretch                  3     4                       1.46345
+    9 Stretch                  3     7                       1.06349
+   10 Stretch                  4     8                       1.06349
+   11 Bend                     1     2     3                60.00000
+   12 Bend                     1     2     4                60.00000
+   13 Bend                     1     2     6               144.73561
+   14 Bend                     1     3     2                60.00000
+   15 Bend                     1     3     4                60.00000
+   16 Bend                     1     3     7               144.73561
+   17 Bend                     1     4     2                60.00000
+   18 Bend                     1     4     3                60.00000
+   19 Bend                     1     4     8               144.73561
+   20 Bend                     2     1     3                60.00000
+   21 Bend                     2     1     4                60.00000
+   22 Bend                     2     1     5               144.73561
+   23 Bend                     2     3     4                60.00000
+   24 Bend                     2     3     7               144.73561
+   25 Bend                     2     4     3                60.00000
+   26 Bend                     2     4     8               144.73561
+   27 Bend                     3     1     4                60.00000
+   28 Bend                     3     1     5               144.73561
+   29 Bend                     3     2     4                60.00000
+   30 Bend                     3     2     6               144.73561
+   31 Bend                     3     4     8               144.73561
+   32 Bend                     4     1     5               144.73561
+   33 Bend                     4     2     6               144.73561
+   34 Bend                     4     3     7               144.73561
+   35 Torsion                  1     2     3     4         -70.52878
+   36 Torsion                  1     2     3     7         144.73561
+   37 Torsion                  1     2     4     3          70.52878
+   38 Torsion                  1     2     4     8        -144.73561
+   39 Torsion                  1     3     2     4          70.52878
+   40 Torsion                  1     3     2     6        -144.73561
+   41 Torsion                  1     3     4     2         -70.52878
+   42 Torsion                  1     3     4     8         144.73561
+   43 Torsion                  1     4     2     3         -70.52878
+   44 Torsion                  1     4     2     6         144.73561
+   45 Torsion                  1     4     3     2          70.52878
+   46 Torsion                  1     4     3     7        -144.73561
+   47 Torsion                  2     1     3     4          70.52878
+   48 Torsion                  2     1     3     7        -144.73561
+   49 Torsion                  2     1     4     3         -70.52878
+   50 Torsion                  2     1     4     8         144.73561
+   51 Torsion                  2     3     1     4         -70.52878
+   52 Torsion                  2     3     1     5         144.73561
+   53 Torsion                  2     3     4     8        -144.73561
+   54 Torsion                  2     4     1     3          70.52878
+   55 Torsion                  2     4     1     5        -144.73561
+   56 Torsion                  2     4     3     7         144.73561
+   57 Torsion                  3     1     2     4         -70.52878
+   58 Torsion                  3     1     2     6         144.73561
+   59 Torsion                  3     1     4     8        -144.73561
+   60 Torsion                  3     2     1     4          70.52878
+   61 Torsion                  3     2     1     5        -144.73561
+   62 Torsion                  3     2     4     8         144.73561
+   63 Torsion                  3     4     1     5         144.73561
+   64 Torsion                  3     4     2     6        -144.73561
+   65 Torsion                  4     1     2     6        -144.73561
+   66 Torsion                  4     1     3     7         144.73561
+   67 Torsion                  4     2     1     5         144.73561
+   68 Torsion                  4     2     3     7        -144.73561
+   69 Torsion                  4     3     1     5        -144.73561
+   70 Torsion                  4     3     2     6         144.73561
+   71 Torsion                  5     1     2     6           0.00000
+   72 Torsion                  5     1     3     7           0.00000
+   73 Torsion                  5     1     4     8           0.00000
+   74 Torsion                  6     2     3     7           0.00000
+   75 Torsion                  6     2     4     8           0.00000
+   76 Torsion                  7     3     4     8           0.00000
+
+
+            XYZ format geometry
+            -------------------
+     8
+ geometry
+ C                     0.51740623    -0.51740623    -0.51740623
+ C                    -0.51740623    -0.51740623     0.51740623
+ C                    -0.51740623     0.51740623    -0.51740623
+ C                     0.51740623     0.51740623     0.51740623
+ H                     1.13141535    -1.13141535    -1.13141535
+ H                    -1.13141535    -1.13141535     1.13141535
+ H                    -1.13141535     1.13141535    -1.13141535
+ H                     1.13141535     1.13141535     1.13141535
+
+ ==============================================================================
+                                internuclear distances
+ ------------------------------------------------------------------------------
+       center one      |      center two      | atomic units |       a.u.
+ ------------------------------------------------------------------------------
+    2 C                |   1 C                |     2.76551  |     2.76551
+    3 C                |   1 C                |     2.76551  |     2.76551
+    3 C                |   2 C                |     2.76551  |     2.76551
+    4 C                |   1 C                |     2.76551  |     2.76551
+    4 C                |   2 C                |     2.76551  |     2.76551
+    4 C                |   3 C                |     2.76551  |     2.76551
+    5 H                |   1 C                |     2.00971  |     2.00971
+    6 H                |   2 C                |     2.00971  |     2.00971
+    7 H                |   3 C                |     2.00971  |     2.00971
+    8 H                |   4 C                |     2.00971  |     2.00971
+ ------------------------------------------------------------------------------
+                         number of included internuclear distances:         10
+ ==============================================================================
+
+
+
+ ==============================================================================
+                                 internuclear angles
+ ------------------------------------------------------------------------------
+        center 1       |       center 2       |       center 3       |  degrees
+ ------------------------------------------------------------------------------
+    1 C                |   2 C                |   3 C                |    60.00
+    1 C                |   2 C                |   4 C                |    60.00
+    2 C                |   1 C                |   5 H                |   144.74
+    1 C                |   3 C                |   4 C                |    60.00
+    3 C                |   1 C                |   5 H                |   144.74
+    4 C                |   1 C                |   5 H                |   144.74
+    2 C                |   1 C                |   3 C                |    60.00
+    2 C                |   1 C                |   4 C                |    60.00
+    1 C                |   2 C                |   6 H                |   144.74
+    2 C                |   3 C                |   4 C                |    60.00
+    3 C                |   2 C                |   6 H                |   144.74
+    4 C                |   2 C                |   6 H                |   144.74
+    3 C                |   1 C                |   2 C                |    60.00
+    3 C                |   1 C                |   4 C                |    60.00
+    1 C                |   3 C                |   7 H                |   144.74
+    3 C                |   2 C                |   4 C                |    60.00
+    2 C                |   3 C                |   7 H                |   144.74
+    4 C                |   3 C                |   7 H                |   144.74
+    4 C                |   1 C                |   2 C                |    60.00
+    4 C                |   1 C                |   3 C                |    60.00
+    1 C                |   4 C                |   8 H                |   144.74
+    4 C                |   2 C                |   3 C                |    60.00
+    2 C                |   4 C                |   8 H                |   144.74
+    3 C                |   4 C                |   8 H                |   144.74
+ ------------------------------------------------------------------------------
+                            number of included internuclear angles:         24
+ ==============================================================================
+
+
+
+  library name resolved from: .nwchemrc
+  library file name is: </sandbox/vama/install/local/nwchem/libraries/>
+  
+                      Basis "ao basis" -> "" (cartesian)
+                      -----
+  H (Hydrogen)
+  ------------
+            Exponent  Coefficients 
+       -------------- ---------------------------------------------------------
+  1 S  1.87311370E+01  0.033495
+  1 S  2.82539370E+00  0.234727
+  1 S  6.40121700E-01  0.813757
+
+  2 S  1.61277800E-01  1.000000
+
+  C (Carbon)
+  ----------
+            Exponent  Coefficients 
+       -------------- ---------------------------------------------------------
+  1 S  3.04752490E+03  0.001835
+  1 S  4.57369510E+02  0.014037
+  1 S  1.03948690E+02  0.068843
+  1 S  2.92101550E+01  0.232184
+  1 S  9.28666300E+00  0.467941
+  1 S  3.16392700E+00  0.362312
+
+  2 S  7.86827240E+00 -0.119332
+  2 S  1.88128850E+00 -0.160854
+  2 S  5.44249300E-01  1.143456
+
+  3 P  7.86827240E+00  0.068999
+  3 P  1.88128850E+00  0.316424
+  3 P  5.44249300E-01  0.744308
+
+  4 S  1.68714400E-01  1.000000
+
+  5 P  1.68714400E-01  1.000000
+
+  6 D  8.00000000E-01  1.000000
+
+
+
+ Summary of "ao basis" -> "" (cartesian)
+ ------------------------------------------------------------------------------
+       Tag                 Description            Shells   Functions and Types
+ ---------------- ------------------------------  ------  ---------------------
+ H                       user specified              2        2   2s
+ C                       user specified              6       15   3s2p1d
+
+
+                              NWChem Property Module
+                              ----------------------
+
+
+                                     C4H4 WFN
+
+                                 NWChem SCF Module
+                                 -----------------
+
+
+                                     C4H4 WFN
+
+
+
+  ao basis        = "ao basis"
+  functions       =    68
+  atoms           =     8
+  closed shells   =    14
+  open shells     =     0
+  charge          =   0.00
+  wavefunction    = RHF 
+  input vectors   = atomic
+  output vectors  = ./c4h4.movecs
+  use symmetry    = F
+  symmetry adapt  = F
+
+
+ Summary of "ao basis" -> "ao basis" (cartesian)
+ ------------------------------------------------------------------------------
+       Tag                 Description            Shells   Functions and Types
+ ---------------- ------------------------------  ------  ---------------------
+ H                       user specified              2        2   2s
+ C                       user specified              6       15   3s2p1d
+
+
+
+ Forming initial guess at       0.1s
+
+
+      Superposition of Atomic Density Guess
+      -------------------------------------
+
+ Sum of atomic energies:        -152.63394675
+
+      Non-variational initial energy
+      ------------------------------
+
+ Total energy =    -156.032121
+ 1-e energy   =    -415.067011
+ 2-e energy   =     152.194722
+ HOMO         =      -0.238814
+ LUMO         =       0.176761
+
+
+ Starting SCF solution at       0.4s
+
+
+
+ ----------------------------------------------
+         Quadratically convergent ROHF
+
+ Convergence threshold     :          1.000E-04
+ Maximum no. of iterations :           30
+ Final Fock-matrix accuracy:          1.000E-07
+ ----------------------------------------------
+
+
+ Integral file          = ./c4h4.aoints.0
+ Record size in doubles =    65536    No. of integs per rec  =    43688
+ Max. records in memory =       88    Max. records in file   =  1390630
+ No. of bits per label  =        8    No. of bits per value  =       64
+
+
+ #quartets = 1.393D+05 #integrals = 2.611D+06 #direct =  0.0% #cached =100.0%
+
+
+              iter       energy          gnorm     gmax       time
+             ----- ------------------- --------- --------- --------
+                 1     -153.5550500345  6.78D-01  1.78D-01      0.9
+                 2     -153.5949540639  1.74D-01  4.16D-02      1.0
+                 3     -153.5978801741  5.05D-03  1.96D-03      1.1
+                 4     -153.5978827607  4.03D-06  7.76D-07      1.4
+
+
+       Final RHF  results 
+       ------------------ 
+
+         Total SCF energy =   -153.597882760733
+      One-electron energy =   -417.605004424173
+      Two-electron energy =    157.166953518255
+ Nuclear repulsion energy =    106.840168145185
+
+        Time for solution =      1.1s
+
+
+             Final eigenvalues
+             -----------------
+
+              1      
+    1  -11.2380
+    2  -11.2365
+    3  -11.2365
+    4  -11.2365
+    5   -1.2966
+    6   -0.8054
+    7   -0.8054
+    8   -0.8054
+    9   -0.7097
+   10   -0.5341
+   11   -0.5341
+   12   -0.5341
+   13   -0.3317
+   14   -0.3317
+   15    0.2670
+   16    0.2942
+   17    0.2942
+   18    0.2942
+   19    0.3453
+   20    0.3453
+   21    0.3453
+   22    0.4027
+   23    0.4027
+   24    0.4027
+
+                       ROHF Final Molecular Orbital Analysis
+                       -------------------------------------
+
+ Vector    5  Occ=2.000000D+00  E=-1.296599D+00
+              MO Center= -3.6D-14, -1.4D-14, -6.2D-15, r^2= 7.7D-01
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     2      0.205349  1 C  s                 17      0.205349  2 C  s          
+    32      0.205349  3 C  s                 47      0.205349  4 C  s          
+
+ Vector    6  Occ=2.000000D+00  E=-8.053911D-01
+              MO Center=  3.6D-01,  2.2D-01,  2.9D-01, r^2= 2.1D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    51      0.342199  4 C  s                 47      0.292917  4 C  s          
+    67      0.187876  8 H  s                  6     -0.164367  1 C  s          
+    46     -0.151160  4 C  s          
+
+ Vector    7  Occ=2.000000D+00  E=-8.053911D-01
+              MO Center=  8.9D-02, -2.3D-01, -2.9D-01, r^2= 2.2D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     6      0.305784  1 C  s                  2      0.261746  1 C  s          
+    36     -0.194200  3 C  s                 21     -0.167248  2 C  s          
+    61      0.167883  5 H  s                 32     -0.166232  3 C  s          
+
+ Vector    8  Occ=2.000000D+00  E=-8.053911D-01
+              MO Center= -4.5D-01,  8.0D-03, -6.2D-03, r^2= 2.2D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    36      0.284647  3 C  s                 21     -0.280270  2 C  s          
+    32      0.243653  3 C  s                 17     -0.239907  2 C  s          
+    65      0.156278  7 H  s                 63     -0.153875  6 H  s          
+
+ Vector    9  Occ=2.000000D+00  E=-7.096543D-01
+              MO Center= -8.2D-14,  5.5D-14,  3.4D-14, r^2= 2.9D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    61      0.148603  5 H  s                 63      0.148603  6 H  s          
+    65      0.148603  7 H  s                 67      0.148603  8 H  s          
+     3      0.134633  1 C  px                 4     -0.134633  1 C  py         
+     5     -0.134633  1 C  pz                18     -0.134633  2 C  px         
+    19     -0.134633  2 C  py                20      0.134633  2 C  pz         
+
+ Vector   10  Occ=2.000000D+00  E=-5.340742D-01
+              MO Center=  2.2D-01, -9.8D-02, -1.2D-01, r^2= 2.1D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    48      0.281123  4 C  px                35     -0.249604  3 C  pz         
+     3     -0.233227  1 C  px                19     -0.231700  2 C  py         
+    61     -0.195240  5 H  s                  5      0.163821  1 C  pz         
+
+ Vector   11  Occ=2.000000D+00  E=-5.340742D-01
+              MO Center= -1.4D-01,  2.0D-01, -1.0D-01, r^2= 2.1D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    49      0.277295  4 C  py                18     -0.258575  2 C  px         
+     5     -0.230246  1 C  pz                34     -0.222932  3 C  py         
+    65     -0.196184  7 H  s                 33      0.181708  3 C  px         
+
+ Vector   12  Occ=2.000000D+00  E=-5.340742D-01
+              MO Center= -7.6D-02, -1.1D-01,  2.2D-01, r^2= 2.1D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    50      0.280051  4 C  pz                 4     -0.244244  1 C  py         
+    20     -0.241255  2 C  pz                33     -0.217603  3 C  px         
+    63     -0.189983  6 H  s                 19      0.162407  2 C  py         
+
+ Vector   13  Occ=2.000000D+00  E=-3.317291D-01
+              MO Center=  3.6D-14, -4.9D-15,  1.9D-14, r^2= 1.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     3      0.234969  1 C  px                18     -0.234969  2 C  px         
+    33     -0.234969  3 C  px                48      0.234969  4 C  px         
+     5      0.201365  1 C  pz                20     -0.201365  2 C  pz         
+    35      0.201365  3 C  pz                50     -0.201365  4 C  pz         
+     7      0.185375  1 C  px                22     -0.185375  2 C  px         
+
+ Vector   14  Occ=2.000000D+00  E=-3.317291D-01
+              MO Center=  4.0D-15,  3.8D-15,  8.6D-15, r^2= 1.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     4     -0.251918  1 C  py                19     -0.251918  2 C  py         
+    34      0.251918  3 C  py                49      0.251918  4 C  py         
+     8     -0.198747  1 C  py                23     -0.198747  2 C  py         
+    38      0.198747  3 C  py                53      0.198747  4 C  py         
+     5      0.155061  1 C  pz                20     -0.155061  2 C  pz         
+
+ Vector   15  Occ=0.000000D+00  E= 2.669763D-01
+              MO Center= -8.3D-12, -6.9D-12,  6.0D-12, r^2= 6.4D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    62      1.116939  5 H  s                 64      1.116939  6 H  s          
+    66      1.116939  7 H  s                 68      1.116939  8 H  s          
+     6     -0.920036  1 C  s                 21     -0.920036  2 C  s          
+    36     -0.920036  3 C  s                 51     -0.920036  4 C  s          
+     7     -0.300056  1 C  px                 8      0.300056  1 C  py         
+
+ Vector   16  Occ=0.000000D+00  E= 2.941798D-01
+              MO Center= -5.5D-01, -5.0D-01,  9.2D-01, r^2= 5.0D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    64      1.871502  6 H  s                 21     -1.606049  2 C  s          
+    68     -1.047123  8 H  s                 51      0.898600  4 C  s          
+    24     -0.525990  2 C  pz                66     -0.480633  7 H  s          
+    22      0.464730  2 C  px                23      0.449927  2 C  py         
+    54      0.433323  4 C  pz                36      0.412460  3 C  s          
+
+ Vector   17  Occ=0.000000D+00  E= 2.941798D-01
+              MO Center=  3.1D-01,  7.3D-01,  1.3D-01, r^2= 5.7D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    68      1.605249  8 H  s                 51     -1.377561  4 C  s          
+    66     -1.251731  7 H  s                 36      1.074186  3 C  s          
+    62     -0.785862  5 H  s                  6      0.674396  1 C  s          
+    53     -0.489395  4 C  py                38      0.449656  3 C  py         
+    52     -0.439016  4 C  px                64      0.432344  6 H  s          
+
+ Vector   18  Occ=0.000000D+00  E= 2.941798D-01
+              MO Center=  2.3D-01, -2.3D-01, -1.1D+00, r^2= 5.2D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    62      1.724928  5 H  s                  6     -1.480265  1 C  s          
+    66     -1.383213  7 H  s                 36      1.187019  3 C  s          
+     9      0.530008  1 C  pz                39     -0.491596  3 C  pz         
+     7     -0.401460  1 C  px                 8      0.396349  1 C  py         
+    37     -0.289143  3 C  px                38      0.284032  3 C  py         
+
+ Vector   19  Occ=0.000000D+00  E= 3.453147D-01
+              MO Center= -5.7D-02, -1.0D-01, -2.1D-01, r^2= 2.9D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     9      0.873697  1 C  pz                39     -0.873697  3 C  pz         
+     8     -0.709759  1 C  py                23      0.709759  2 C  py         
+    22     -0.466621  2 C  px                37      0.466621  3 C  px         
+    38     -0.407076  3 C  py                53      0.407076  4 C  py         
+     5      0.244113  1 C  pz                24      0.243138  2 C  pz         
+
+ Vector   20  Occ=0.000000D+00  E= 3.453147D-01
+              MO Center= -1.9D-01,  1.6D-01,  1.6D-01, r^2= 2.9D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    22     -0.801679  2 C  px                37      0.801679  3 C  px         
+    24     -0.739627  2 C  pz                54      0.739627  4 C  pz         
+    38      0.733688  3 C  py                53     -0.733688  4 C  py         
+    18     -0.223991  2 C  px                33      0.223991  3 C  px         
+    20     -0.206653  2 C  pz                50      0.206653  4 C  pz         
+
+ Vector   21  Occ=0.000000D+00  E= 3.453147D-01
+              MO Center=  2.5D-01, -5.8D-02,  4.8D-02, r^2= 2.9D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     7      0.917257  1 C  px                52     -0.917257  4 C  px         
+     8      0.600552  1 C  py                23     -0.600552  2 C  py         
+    24     -0.511964  2 C  pz                54      0.511964  4 C  pz         
+    38     -0.405293  3 C  py                53      0.405293  4 C  py         
+     9      0.316705  1 C  pz                39     -0.316705  3 C  pz         
+
+ Vector   22  Occ=0.000000D+00  E= 4.027474D-01
+              MO Center= -7.0D-02,  7.8D-02,  5.7D-02, r^2= 4.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     6      3.899472  1 C  s                  9      2.375724  1 C  pz         
+     7     -2.248635  1 C  px                 8      2.186829  1 C  py         
+    62      2.073174  5 H  s                 21     -1.664410  2 C  s          
+    24      1.415934  2 C  pz                51     -1.394762  4 C  s          
+    54      1.300140  4 C  pz                22     -1.288845  2 C  px         
+
+ Vector   23  Occ=0.000000D+00  E= 4.027474D-01
+              MO Center=  6.4D-02, -8.3D-02,  4.6D-02, r^2= 4.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    36      3.824977  3 C  s                 39      2.411101  3 C  pz         
+    37      2.198360  3 C  px                38     -2.071607  3 C  py         
+    66      2.033568  7 H  s                 51     -1.953038  4 C  s          
+    54      1.607245  4 C  pz                21     -1.400043  2 C  s          
+    52      1.394503  4 C  px                24      1.369775  2 C  pz         
+
+ Vector   24  Occ=0.000000D+00  E= 4.027474D-01
+              MO Center=  5.7D-03,  4.8D-03, -1.0D-01, r^2= 4.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+    21      3.277244  2 C  s                 51     -3.116246  4 C  s          
+    23      2.205560  2 C  py                53      2.136424  4 C  py         
+    22      2.074554  2 C  px                52      2.005417  4 C  px         
+    64      1.742363  6 H  s                 68     -1.656767  8 H  s          
+    24     -1.444231  2 C  pz                54      1.301290  4 C  pz         
+
+ Vector   25  Occ=0.000000D+00  E= 6.408515D-01
+              MO Center=  9.2D-15,  4.1D-14,  2.4D-13, r^2= 3.8D+00
+   Bfn.  Coefficient  Atom+Function         Bfn.  Coefficient  Atom+Function  
+  ----- ------------  ---------------      ----- ------------  ---------------
+     2      0.461575  1 C  s                 17      0.461575  2 C  s          
+    32      0.461575  3 C  s                 47      0.461575  4 C  s          
+     6     -0.441380  1 C  s                 21     -0.441380  2 C  s          
+    36     -0.441380  3 C  s                 51     -0.441380  4 C  s          
+    61      0.342233  5 H  s                 63      0.342233  6 H  s          
+
+
+ center of mass
+ --------------
+ x =   0.00000000 y =   0.00000000 z =   0.00000000
+
+ moments of inertia (a.u.)
+ ------------------
+         128.633392678965           0.000000000000           0.000000000000
+           0.000000000000         128.633392678965           0.000000000000
+           0.000000000000           0.000000000000         128.633392678965
+
+  Mulliken analysis of the total density
+  --------------------------------------
+
+    Atom       Charge   Shell Charges
+ -----------   ------   -------------------------------------------------------
+    1 C    6     6.22   2.00  0.63  2.06  0.57  0.87  0.09
+    2 C    6     6.22   2.00  0.63  2.06  0.57  0.87  0.09
+    3 C    6     6.22   2.00  0.63  2.06  0.57  0.87  0.09
+    4 C    6     6.22   2.00  0.63  2.06  0.57  0.87  0.09
+    5 H    1     0.78   0.51  0.27
+    6 H    1     0.78   0.51  0.27
+    7 H    1     0.78   0.51  0.27
+    8 H    1     0.78   0.51  0.27
+
+       Multipole analysis of the density wrt the origin
+       ------------------------------------------------
+
+     L   x y z        total         open         nuclear
+     -   - - -        -----         ----         -------
+     0   0 0 0     -0.000000      0.000000     28.000000
+
+     1   1 0 0     -0.000000      0.000000      0.000000
+     1   0 1 0      0.000000      0.000000      0.000000
+     1   0 0 1     -0.000000      0.000000      0.000000
+
+     2   2 0 0    -16.808457      0.000000     41.229451
+     2   1 1 0      0.000000      0.000000      0.000000
+     2   1 0 1      0.000000      0.000000      0.000000
+     2   0 2 0    -16.808457      0.000000     41.229451
+     2   0 1 1      0.000000      0.000000      0.000000
+     2   0 0 2    -16.808457      0.000000     41.229451
+
+
+ Parallel integral file used      60 records with       0 large values
+
+
+
+                                   WFX file creator
+                                -------------------
+
+              Total Energy E =   -153.59788276073294     
+            Kinetic Energy V =    153.51488873663004     
+          Potential Energy T =   -307.11277149736298     
+             Virial ABS(V/T) =    2.0005406252434921     
+    Name of Final wnf-file  ./c4h4.wfn                                                                      
+
+ Task  times  cpu:        1.4s     wall:        1.4s
+
+
+                                NWChem Input Module
+                                -------------------
+
+
+ Summary of allocated global arrays
+-----------------------------------
+  No active global arrays
+
+
+
+                         GA Statistics for process    0
+                         ------------------------------
+
+       create   destroy   get      put      acc     scatter   gather  read&inc
+calls:  194      194     4818     3258     2208        0        0        0     
+number of processes/call 1.00e+00 1.00e+00 1.00e+00 0.00e+00 0.00e+00
+bytes total:             8.79e+06 5.86e+06 1.32e+06 0.00e+00 0.00e+00 0.00e+00
+bytes remote:            0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
+Max memory consumed for GA by this process: 480896 bytes
+
+MA_summarize_allocated_blocks: starting scan ...
+MA_summarize_allocated_blocks: scan completed: 0 heap blocks, 0 stack blocks
+MA usage statistics:
+
+	allocation statistics:
+					      heap	     stack
+					      ----	     -----
+	current number of blocks	         0	         0
+	maximum number of blocks	        17	        20
+	current total bytes		         0	         0
+	maximum total bytes		  46165344	  22510632
+	maximum total K-bytes		     46166	     22511
+	maximum total M-bytes		        47	        23
+
+
+                                     CITATION
+                                     --------
+                Please cite the following reference when publishing
+                           results obtained with NWChem:
+
+                 M. Valiev, E.J. Bylaska, N. Govind, K. Kowalski,
+              T.P. Straatsma, H.J.J. van Dam, D. Wang, J. Nieplocha,
+                        E. Apra, T.L. Windus, W.A. de Jong
+                 "NWChem: a comprehensive and scalable open-source
+                  solution for large scale molecular simulations"
+                      Comput. Phys. Commun. 181, 1477 (2010)
+                           doi:10.1016/j.cpc.2010.04.018
+
+                              AUTHORS & CONTRIBUTORS
+                              ----------------------
+      E. J. Bylaska, W. A. de Jong, N. Govind, K. Kowalski, T. P. Straatsma,
+     M. Valiev, H. J. J. van Dam, D. Wang, E. Apra, T. L. Windus, J. Hammond,
+    J. Autschbach, F. Aquino, J. Mullin, P. Nichols, S. Hirata, M. T. Hackler,
+   Y. Zhao, P.-D. Fan, R. J. Harrison, M. Dupuis, D. M. A. Smith, K. Glaesemann,
+    J. Nieplocha, V. Tipparaju, M. Krishnan, A. Vazquez-Mayagoitia, L. Jensen,
+      M. Swart, Q. Wu, T. Van Voorhis, A. A. Auer, M. Nooijen, L. D. Crosby,
+        E. Brown, G. Cisneros, G. I. Fann, H. Fruchtl, J. Garza, K. Hirao,
+        R. Kendall, J. A. Nichols, K. Tsemekhman, K. Wolinski, J. Anchell,
+       D. Bernholdt, P. Borowski, T. Clark, D. Clerc, H. Dachsel, M. Deegan,
+        K. Dyall, D. Elwood, E. Glendening, M. Gutowski, A. Hess, J. Jaffe,
+        B. Johnson, J. Ju, R. Kobayashi, R. Kutteh, Z. Lin, R. Littlefield,
+    X. Long, B. Meng, T. Nakajima, S. Niu, L. Pollack, M. Rosing, G. Sandrone,
+       M. Stave, H. Taylor, G. Thomas, J. H. van Lenthe, A. Wong, Z. Zhang.
+
+ Total times  cpu:        1.4s     wall:        1.5s
diff -Nur nwchem-6.3-ref/doc/user/property.tex nwchem-6.3/doc/user/property.tex
--- nwchem-6.3-ref/doc/user/property.tex	2013-05-17 19:40:51.000000000 -0500
+++ nwchem-6.3/doc/user/property.tex	2013-07-31 11:24:58.191386612 -0500
@@ -52,6 +52,7 @@
   HYPERFINE
   SHIELDING [<integer> number_of_atoms <integer> atom_list]
   SPINSPIN [<integer> number_of_pairs <integer> pair_list]
+  AIMFILE
   ALL
 \end{verbatim}
 
@@ -100,3 +101,16 @@
 to provide additional options to the NBO calculation, (see the NBO
 user's manual for details.)  
 
+\subsection{AIM file}
+\label{sec:AIMfile}
+
+The keyword {\tt aimfile} creates a \verb+.wfn+ file from a given 
+eigenvector file (i.e., \verb+.movecs+), geometry and a basis set. 
+The \verb+.wfn+ file summarizes the single determinant wavefunction in order to be analyzed 
+through a third-party software.
+Among some known analyses are the Bader's approach for atoms in molecules (AIM), the electron 
+localization function (ELF), the Fermi hole function and energy density analysis.
+The follow input directive will create the an AIM file \verb+.wfx+ format.
+\begin{verbatim}
+ set prop:nowfx F
+\end{verbatim}
diff -Nur nwchem-6.3-ref/src/property/GNUmakefile nwchem-6.3/src/property/GNUmakefile
--- nwchem-6.3-ref/src/property/GNUmakefile	2013-05-17 19:39:06.000000000 -0500
+++ nwchem-6.3/src/property/GNUmakefile	2013-07-31 11:25:35.977092168 -0500
@@ -67,6 +67,7 @@
 	 task_raman.o \
 	 raman_input.o \
 	 raman.o \
+         waimfile.o \
 	 prop_grid.o
 
 #   OBJ = aoresponse_giao_rhs.o
diff -Nur nwchem-6.3-ref/src/property/prop.F nwchem-6.3/src/property/prop.F
--- nwchem-6.3-ref/src/property/prop.F	2013-05-17 19:39:06.000000000 -0500
+++ nwchem-6.3/src/property/prop.F	2013-07-31 11:26:34.521537121 -0500
@@ -9,7 +9,7 @@
 *
       implicit none
       integer rtdb              ! [input]
-      integer nbofile
+      integer nbofile,aimfile
       logical status
       logical  hnd_property
       external hnd_property
@@ -42,6 +42,9 @@
       if (rtdb_get(rtdb,'prop:nbofile',MT_INT,1,nbofile)) then
         if(nbofile.eq.1) call wnbofile(rtdb)
       endif 
+      if (rtdb_get(rtdb,'prop:aimfile',MT_INT,1,aimfile)) then
+        if(aimfile.eq.1) call waimfile(rtdb)
+      endif
 c
 c     finish ecce property output module
 c
diff -Nur nwchem-6.3-ref/src/property/prop_input.F nwchem-6.3/src/property/prop_input.F
--- nwchem-6.3-ref/src/property/prop_input.F	2013-05-17 19:39:06.000000000 -0500
+++ nwchem-6.3/src/property/prop_input.F	2013-07-31 11:46:46.195957486 -0500
@@ -25,6 +25,7 @@
       integer hypfile, hypopt
       integer efgfile, efgopt
       integer nbofile, nboopt
+      integer aimfile
       integer dipole
       integer quadrupole
       integer octupole
@@ -76,6 +77,7 @@
 c
 c>>>  Default property settings.
 c
+      aimfile           = 0
       nbofile           = 0
       nboopt            = 0
       efgfile           = 0 
@@ -391,6 +393,9 @@
          dipole  = 0
       elseif ( inp_compare(.false., 'nbofile', test)) then
          nbofile = 1
+      elseif ( inp_compare(.false., 'aimfile', test)) then
+         aimfile = 1
+      elseif ( inp_compare(.false., 'all', test)) then
 c ... jochen: read an option (integer value) to define 
 c     what NBO options will appear    
           if (inp_i(nboopt)) then 
@@ -444,6 +449,7 @@
          quadrupole  = 0
          dipole    = 0
          nbofile   = 1
+         aimfile = 0
          efgfile   = 1
          hypfile   = 1
          gshiftfile= 1
@@ -501,6 +507,9 @@
       if (.not. rtdb_put(rtdb, 'prop:nbofile', mt_int, 1,
      $                               nbofile           ))
      $     call errquit('prop_input: rtdb_put failed', 0, RTDB_ERR)
+      if (.not. rtdb_put(rtdb, 'prop:aimfile', mt_int, 1,
+     $                               aimfile           ))
+     $     call errquit('prop_input: rtdb_put failed', 0, RTDB_ERR)
 c ... jochen: also write NBO option key to RTDB:
       if (.not. rtdb_put(rtdb, 'prop:nboopt', mt_int, 1,
      $                               nboopt           ))
diff -Nur nwchem-6.3-ref/src/property/waimfile.F nwchem-6.3/src/property/waimfile.F
--- nwchem-6.3-ref/src/property/waimfile.F	1969-12-31 18:00:00.000000000 -0600
+++ nwchem-6.3/src/property/waimfile.F	2013-07-31 11:47:06.362732616 -0500
@@ -0,0 +1,1581 @@
+      subroutine  waimfile(rtdb)
+      implicit none
+#include "errquit.fh"
+#include "bas.fh"
+#include "geom.fh"
+#include "global.fh"
+#include "mafdecls.fh"
+#include "rtdb.fh"
+#include "stdio.fh"
+#include "inp.fh"
+#include "util.fh"
+#include "nwc_const.fh"
+#include "geomP.fh"
+c
+c   This subroutine was designed to creat a WFN/WFX file
+c   within a nwchem movecs file.
+c   The format used is the same as the requeried for 
+c   codes to do topological analyses as Atoms In Molecules 
+c   theories and Electron Localization Function.
+c
+      integer       rtdb
+      integer       geom, basis
+      character*255 vec_file
+      character*255 titlel_vec,  basis_name
+      character*32  theory
+c
+      integer numcont           ! number of mapped contractions
+      integer icont             ! contraction index
+      integer type              ! type (sp/s/p/d/..)
+c      integer nprim            ! no. of primitives per shell
+      integer ngeno             ! no. of contractions
+      integer sphcart           ! 0/1 for cartesian/shperical
+      integer iset
+      logical status
+c
+      integer kprim             ! sum of primitives per shell
+      integer primprim          ! sum of the total of primitives used
+      integer sprimprim         ! cartesian primitives after transformation from spherical
+c
+      double precision total_charge
+c
+      character*(nw_max_path_len) wfnfile
+      character*255 title
+      character*255 title_vec
+      character*20 scftype
+      integer nset
+      integer nbf
+      integer nmo(2)
+      integer g_vecs(2)
+      integer g_hcore(2)
+      integer g_dens(2)
+c
+      double precision ekin, virial, epot
+      double precision etot
+c
+      double precision forderco(21)
+c
+      integer nocc(2)
+      integer noccs
+c
+      integer l_icent, k_icent, l_ricent, k_ricent
+      integer l_itype, k_itype, l_ritype, k_ritype
+      integer ls_ritype, ks_ritype
+      integer ls_ricent, ks_ricent
+      integer ls_rexp, ks_rexp
+      integer ls_rcoef, ks_rcoef
+      integer l_exp, k_exp, l_rexp, k_rexp
+      integer l_rprim, k_rprim
+      integer l_eval(2), k_eval(2)
+      integer l_vecs, k_vecs  
+      integer l_coef, k_coef, l_rcoef, k_rcoef !basis coefficients
+      integer l_co, k_co
+      integer ls_co, ks_co
+      integer l_tprim, k_tprim
+      integer l_nprim, k_nprim
+      integer l_occ(2), k_occ(2)
+c
+      integer idum
+      integer i,j,k,l,n,m
+      integer naco
+c
+      integer natoms
+c
+      double precision coord(3,nw_max_atom)
+      double precision xyz(3)
+      character*16 tag
+      character*80 buf
+      double precision qnuc(nw_max_atom)
+      character*4 symbol(nw_max_atom)
+      integer atn
+      character*16 rhf
+c
+      integer rprims(6)
+      integer rprimc(6)
+c functions per type or orbital
+      data rprims /1, 3, 5, 7, 9, 11/ !wrong 
+      data rprimc /1, 3, 6, 10, 15, 21/
+c
+      logical nowfx
+c
+      logical movecs_read_header
+      external movecs_read_header
+c
+      logical movecs_read
+      external movecs_read
+c
+      integer ga_create_atom_blocked
+      external ga_create_atom_blocked
+c
+      logical int_normalize
+      external int_normalize
+c
+      logical waimfile_printwfn, waimfile_printwfx, waimfile_sph2cart
+      external waimfile_printwfn , waimfile_printwfx, waimfile_sph2cart
+c
+      integer cartbf(-1:5,1:21)
+      integer sphebf(-1:5,1:11)
+c
+
+      character*4 atmsymbol(109)
+      data atmsymbol/'  H ','  HE','  LI','  BE','  B ','  C ',
+     *               '  N ','  O ','  F ','  NE','  NA','  MG',
+     *               '  AL','  SI','  P ','  S ','  CL','  AR',
+     *               '  K ','  CA','  SC','  TI','  V ','  CR',
+     *               '  MN','  FE','  CO','  NI','  CU','  ZN',
+     *               '  GA','  GE','  AS','  SE','  BR','  KR',
+     *               '  RB','  SR','  Y ','  ZR','  NB','  MO',
+     *               '  TC','  RU','  RH','  PD','  AG','  CD',
+     *               '  IN','  SN','  SB','  TE','  I ','  XE',
+     *               '  CS','  BA','  LA','  CE','  PR','  ND',
+     *               '  PM','  SM','  EU','  GD','  TB','  DY',
+     *               '  HO','  ER','  TM','  YB','  LU','  HF',
+     *               '  TA','  W ','  RE','  OS','  IR','  PT',
+     *               '  AU','  HG','  TL','  PB','  BI','  PO',
+     *               '  AT','  RN','  FR','  RA','  AC','  TH',
+     *               '  PA','  U ','  NP','  PU','  AM','  CM',
+     *               '  BK','  CF','  ES','  FM','  MD','  NO',
+     *               '  LR','  RF','  DB','  SG','  BH','  HS', 
+     *               '  MT'/
+c L
+      cartbf(-1,1) = 1
+      cartbf(-1,2) = 2
+      cartbf(-1,3) = 3
+      cartbf(-1,4) = 4
+c 1 S
+      cartbf(0, 1) = 1
+c 2 PX
+      cartbf(1, 1) = 2
+c 3 PY
+      cartbf(1, 2) = 3
+c 4 PZ
+      cartbf(1, 3) = 4
+c 5 DXX
+      cartbf(2, 1) = 5
+c 8 DXY
+      cartbf(2, 2) = 8
+c 9 DXZ
+      cartbf(2, 3) = 9
+c 6 DYY
+      cartbf(2, 4) = 6
+c 10 DYZ
+      cartbf(2, 5) = 10
+c 7 DZZ
+      cartbf(2, 6) = 7
+c 11 FXXX
+      cartbf(3, 1) = 11
+c 14 FXXY
+      cartbf(3, 2) = 14
+c 15 FXXZ
+      cartbf(3, 3) = 15
+c 17 FXYY
+      cartbf(3, 4) = 17
+c 20 FXYZ
+      cartbf(3, 5) = 20
+c 18 FXZZ
+      cartbf(3, 6) = 18
+c 12 FYYY
+      cartbf(3, 7) = 12
+c 16 FYYZ
+      cartbf(3, 8) = 16
+c 19 FYZZ
+      cartbf(3, 9) = 19
+c 13 FZZZ
+      cartbf(3,10) = 13
+c 21 GXXXX
+      cartbf(4, 1) = 21
+c 24 GXXXY
+      cartbf(4, 2) = 24
+c 25 GXXXZ
+      cartbf(4, 3) = 25
+c 30 GXXYY
+      cartbf(4, 4) = 30
+c 33 GXXYZ
+      cartbf(4, 5) = 33
+c 31 GXXZZ
+      cartbf(4, 6) = 31
+c 26 GXYYY
+      cartbf(4, 7) = 26
+c 34 GXYYZ
+      cartbf(4, 8) = 34
+c 35 GXYZZ
+      cartbf(4, 9) = 35
+c 28 GXZZZ
+      cartbf(4,10) = 28
+c 22 GYYYY
+      cartbf(4,11) = 22
+c 27 GYYYZ
+      cartbf(4,12) = 27
+c 32 GYYZZ
+      cartbf(4,13) = 32
+c 29 GYZZZ
+      cartbf(4,14) = 29
+c 23 GZZZZ
+c    cartbf(4,15) = 'zzzz'
+      cartbf(4,15) = 23
+
+c 56 HXXXXX (500)
+c      cartbf(5, 1) = 'xxxxx'
+      cartbf(5, 1) = 56
+c 55 HXXXXY (410)
+c      cartbf(5, 2) = 'xxxxy'
+      cartbf(5, 2) = 55
+c 54 HXXXXZ (401)
+c      cartbf(5, 3) = 'xxxxz'
+      cartbf(5, 3) = 54
+c 53 HXXXYY (320)
+c      cartbf(5, 4) = 'xxxyy'
+      cartbf(5, 4) = 53
+c 52 HXXXYZ (311)
+c      cartbf(5, 5) = 'xxxyz'
+      cartbf(5, 5) = 52
+c 51 HXXXZZ (302)
+c      cartbf(5, 6) = 'xxxzz'
+      cartbf(5, 6) = 51
+c 50 HXXYYY (230)
+c      cartbf(5, 7) = 'xxyyy'
+      cartbf(5, 7) = 50
+c 49 HXXYYZ (221)
+c      cartbf(5, 8) = 'xxyyz'
+      cartbf(5, 8) = 49
+c 48 HXXYZZ (212)
+c      cartbf(5, 9) = 'xxyzz'
+      cartbf(5, 9) = 48
+c 47 HXXZZZ (203)
+c      cartbf(5,10) = 'xxzzz'
+      cartbf(5, 10) = 47
+c 46 HXYYYY (140)
+c      cartbf(5,11) = 'xyyyy'
+      cartbf(5, 11) = 46
+c 45 HXYYYZ (131)
+c      cartbf(5,12) = 'xyyyz'
+      cartbf(5, 12) = 45
+c 44 HXYYZZ (122)
+c      cartbf(5,13) = 'xyyzz'
+      cartbf(5, 13) = 44
+c 43 HXYZZZ (113)
+c      cartbf(5,14) = 'xyzzz'
+      cartbf(5, 14) = 43
+c 42 HXZZZZ (104)
+c      cartbf(5,15) = 'xzzzz'
+      cartbf(5, 15) = 42
+c 41 HYYYYY (050)
+c      cartbf(5,16) = 'yyyyy'
+      cartbf(5, 16) = 41
+c 40 HYYYYZ (041)
+c      cartbf(5,17) = 'yyyyz'
+      cartbf(5, 17) = 40
+c 39 HYYYZZ (032)
+c      cartbf(5,18) = 'yyyzz'
+      cartbf(5, 18) = 39
+c 38 HYYZZZ (023)
+c      cartbf(5,19) = 'yyzzz'
+      cartbf(5, 19) = 38
+c 37 HYZZZZ (014)
+c      cartbf(5,20) = 'yzzzz'
+      cartbf(5, 20) = 37
+c 36 HZZZZZ (005)
+c      cartbf(5,21) = 'zzzzz'
+      cartbf(5, 21) = 36
+
+      sphebf(-1,1) = 1
+      sphebf(-1,2) = 2
+      sphebf(-1,3) = 3
+      sphebf(-1,4) = 4
+      sphebf(0, 1) = 1
+      sphebf(1, 1) = 2
+      sphebf(1, 2) = 3
+      sphebf(1, 3) = 4
+      sphebf(2, 1) = 5
+      sphebf(2, 2) = 6
+      sphebf(2, 3) = 7
+      sphebf(2, 4) = 8
+      sphebf(2, 5) = 9
+      sphebf(3, 1) = 10
+      sphebf(3, 2) = 11
+      sphebf(3, 3) = 12
+      sphebf(3, 4) = 13
+      sphebf(3, 5) = 14
+      sphebf(3, 6) = 15
+      sphebf(3, 7) = 16
+      sphebf(4, 1) = 17
+      sphebf(4, 2) = 18
+      sphebf(4, 3) = 19
+      sphebf(4, 4) = 20
+      sphebf(4, 5) = 21
+      sphebf(4, 6) = 22
+      sphebf(4, 7) = 23
+      sphebf(4, 8) = 24
+      sphebf(4, 9) = 25
+      sphebf(5, 1) = 26
+      sphebf(5, 2) = 37
+      sphebf(5, 3) = 38
+      sphebf(5, 4) = 39
+      sphebf(5, 5) = 40
+      sphebf(5, 6) = 41
+      sphebf(5, 7) = 42
+      sphebf(5, 8) = 43
+      sphebf(5, 9) = 44
+      sphebf(5, 10) = 45
+      sphebf(5, 11) = 46
+     
+c> open wfn file
+c
+      buf = ' '
+      write(buf,*) '  WFX file creator '
+      write(6,*)
+      write(6,*)
+      call util_print_centered(6,buf,40,.true.)
+      write(6,*)
+c
+c> get title
+      if(.not. rtdb_cget(rtdb, 'title', 1, title)) title = 'NWChem Job '
+
+c> wfn / wfx
+      if (.not. rtdb_get(rtdb, 'prop:nowfx',mt_log, 1, nowfx))
+     $      nowfx=.true.
+c
+
+c>  load geometry and symmetry info
+      if (.not. geom_create(geom, 'geometry'))
+     $     call errquit('waimfile : geom_create?', 0, GEOM_ERR)
+      if (.not. geom_rtdb_load(rtdb, geom, 'geometry'))
+     $     call errquit('waimfile : no geometry ', 0, RTDB_ERR)
+      if (.not.geom_ncent(geom, natoms))
+     $   call errquit('waimfile : error code = ',2,GEOM_ERR)
+      if (.not. geom_nuc_charge(geom,total_charge))
+     $    call errquit('waimfile: failed to read total charge',
+     &     0, RTDB_ERR)
+
+c> geometry
+      do i=1,natoms
+        if (.not.geom_cent_get(geom, i, tag, 
+     $                           xyz, qnuc(i)))
+     $       call errquit('waimfile : error code = ',3,GEOM_ERR)
+        if (tag(1:2) .eq. 'bq' .or. 
+     $       ((tag(1:1).eq.'x') .and. (tag(2:2).ne.'e'))) then ! X but not Xe
+            symbol(i) = '  Bq '
+        else
+            symbol(i) = atmsymbol(int(qnuc(i)))
+        endif
+        coord(1,i)=xyz(1)
+        coord(2,i)=xyz(2)
+        coord(3,i)=xyz(3)
+      enddo
+
+
+c>  load the basis set and get info about it
+c
+      if (.not. bas_create(basis, 'ao basis'))
+     $     call errquit('waimfile : bas_create?', 0, BASIS_ERR)
+      if (.not. bas_rtdb_load(rtdb, geom, basis, 'ao basis')) then
+         if (.not. bas_rtdb_load(rtdb, geom, basis, 'mo basis'))
+     $        call errquit('waimfile : no mo or ao basis set', 0,
+     &       RTDB_ERR)
+      endif
+c
+      if (.not. int_normalize(rtdb,basis)) call errquit
+     &    ('waimfile : int_normalize failed',911, INT_ERR)
+c
+c> READ vectors from movecs file
+c
+      if (.not. rtdb_cget(rtdb, 'prop:vectors',  1,
+     $     vec_file)) then
+           call util_file_name('movecs', .false.,.false.,vec_file )
+      endif
+      call util_file_name_resolve(vec_file, .false.)
+c> movecs 
+      if (.not. movecs_read_header(vec_file, title_vec, basis_name,
+     &    scftype, nbf, nset, nmo, 2))
+     &  call errquit('waimfile : basis set error:', 86, basis_err)
+c
+c
+      if (.not. ma_push_get(mt_dbl,nbf,'occ',l_occ(1),k_occ(1)))
+     &    call errquit('waimfile : failed to allocate orb.',nbf,MA_ERR)
+      if (.not. ma_push_get(mt_dbl,nbf,'eigenval',l_eval(1),k_eval(1)))
+     &    call errquit('waimfile : failed to allocate orb.',nbf,MA_ERR)
+      if (.not. ma_push_get(mt_dbl,nbf,'movecs_read',
+     $                                          l_vecs,k_vecs))
+     $    call errquit('waimfile : ma failed', nbf, MA_ERR)
+
+c     if (nset.eq.2) then
+        if (.not. ma_push_get(mt_dbl,nbf,'occ',l_occ(2),k_occ(2)))
+     &    call errquit('waimfile : failed to allocate orb.',nbf,MA_ERR)
+        if (.not. ma_push_get(mt_dbl,nbf,'eigenval',
+     &                                          l_eval(2),k_eval(2)))
+     &    call errquit('waimfile : failed to allocate orb.',nbf,MA_ERR)
+c     endif
+
+      g_vecs(1) = ga_create_atom_blocked(geom, basis, 'vecs1')
+      call ga_zero(g_vecs(1))
+      if (nset.eq.2) then
+        g_vecs(2) = ga_create_atom_blocked(geom, basis, 'vecs2')
+        call ga_zero(g_vecs(2))
+      endif
+c
+c> determine orb occupation
+      nocc(1) = 0
+      nocc(2) = 0
+      do iset = 1, nset
+        if (.not. movecs_read(vec_file, iset, dbl_mb(k_occ(iset)),
+     $            dbl_mb(k_eval(iset)), g_vecs(iset))) call errquit
+     $              ('waimfile  fragment: failed read fragment MOs',0,
+     $               INPUT_ERR)
+        do i=1,nbf
+c> count electrons
+        if ( dbl_mb(k_occ(iset)+i-1).gt.1.0d-1) 
+     $                       nocc(iset) = nocc(iset) + 1
+        enddo
+      enddo
+
+c>  total occupation
+      noccs = nocc(1)
+      if (nset.gt.1) noccs = noccs + nocc(2)
+      
+
+c> total of contractions
+      if (.not.bas_numcont(basis,numcont))
+     $   call errquit('waimfile : error code = ',2,BASIS_ERR)
+
+c> expand basis representation
+
+      if (.not. ma_push_get(mt_int,numcont,'nprim',l_nprim,k_nprim))
+     $    call errquit('waimfile : ma failedi nprim', numcont, MA_ERR)
+      if (.not. ma_push_get(mt_int,numcont,'tprim', l_tprim, k_tprim))
+     $    call errquit('waimfile : ma failed tprim', numcont, MA_ERR)
+      if (.not. ma_push_get(mt_int,numcont,'rprim',l_rprim,k_rprim))
+     $    call errquit('waimfile : ma failed rprim', numcont, MA_ERR)
+      if (.not. ma_push_get(mt_int,numcont,'icent',l_icent,k_icent))
+     &  call errquit('waimfile : failed icent icent.',numcont,MA_ERR)
+c
+      primprim = 0
+      kprim = 0
+      do icont = 1, numcont
+        if (.not. bas_continfo(basis, icont, type,
+     $                    int_mb(k_nprim+icont-1), ngeno,sphcart))
+     $    call errquit('waimfile : error code = ',3,BASIS_ERR)
+c
+        if (sphcart.eq.1) then
+c          write (6,*) 'SPHERICAL BASIS WARNING'
+           int_mb(k_rprim+icont-1) = rprims(type+1)
+        else
+           int_mb(k_rprim+icont-1) = rprimc(type+1)
+        endif
+c
+        int_mb(k_tprim+icont-1) = 
+     $                 int_mb(k_rprim+icont-1)*int_mb(k_nprim+icont-1)
+        primprim = primprim + int_mb(k_tprim+icont-1)
+c
+        if (.not. bas_cn2ce(basis, icont, i))
+     $    call errquit('waimfile : error code = ',5,BASIS_ERR)
+c
+        int_mb(k_icent+icont-1) = i
+        kprim = kprim + int_mb(k_nprim+icont-1)
+      enddo
+c
+c*      do icont = 1, numcont
+c*        write(6,*) 'debug icont ', icont
+c*        write(6,*) 'debug    nprim ', int_mb(k_nprim+icont-1)
+c*        write(6,*) 'debug    rprim ', int_mb(k_rprim+icont-1)
+c*        write(6,*) 'debug      tprim ', int_mb(k_tprim+icont-1)
+c*      enddo
+c
+      if (.not. ma_push_get(mt_dbl,kprim,'exponents', l_exp, k_exp))
+     $  call errquit('waimfile : ma failed exp', kprim, MA_ERR)
+      if (.not. ma_push_get(mt_dbl,kprim,'coeffts', l_coef, k_coef))
+     $  call errquit('waimfile : ma failed exp', kprim, MA_ERR)
+
+      kprim = 0
+      do icont = 1, numcont
+        if (.not.bas_get_exponent(basis, icont,
+     $                                     dbl_mb(k_exp + kprim)))
+     $      call errquit('waimfile : failed bas_get_exponent',0,
+     $       BASIS_ERR)
+
+        if (.not.bas_get_coeff(basis, icont, dbl_mb(k_coef + kprim)))
+     $         call errquit('waimfile : failed bas_get_coeff',0,
+     &       BASIS_ERR)
+
+        kprim = kprim + int_mb(k_nprim+icont-1)
+      enddo
+c
+      if (.not. ma_push_get( mt_dbl, primprim, 'rexponents', 
+     $                                               l_rexp, k_rexp))
+     $  call errquit('waimfile : ma failed exp', primprim, MA_ERR)
+      if (.not. ma_push_get( mt_dbl, primprim, 'rcoefficients', 
+     $                                               l_rcoef, k_rcoef))
+     $  call errquit('waimfile : ma failed exp', primprim, MA_ERR)
+      if (.not. ma_push_get( mt_int, primprim, 'ricent',
+     $                                               l_ricent,k_ricent))
+     &  call errquit('waimfile : failed icent.',primprim,MA_ERR)
+      if (.not. ma_push_get( mt_int, primprim, 'ritype',
+     $                                               l_ritype,k_ritype))
+     &  call errquit('waimfile : failed itype.',primprim,MA_ERR)
+c
+c
+c
+      k = 0
+      l = 1
+      m = 0
+      do icont = 1, numcont
+c> determine number type
+        if (.not. bas_continfo(basis, icont, type,
+     $                                        idum, ngeno,sphcart))
+     $        call errquit('waimfile : error code = ',3,BASIS_ERR)
+        n=1
+        do i = 1 + k, int_mb(k_rprim+icont-1) + k
+          do j = 1  , int_mb(k_nprim+icont-1) 
+c> itype   1:numcount to ritype   1:primprim
+            if (sphcart.eq.1) then
+                int_mb(k_ritype+l-1) = sphebf(type,n)
+            else
+                int_mb(k_ritype+l-1) = cartbf(type,n)
+            endif
+c> exp     1:kprim    to rexp     1:primprim
+            dbl_mb(k_rexp+l-1) = dbl_mb(k_exp+m+j-1)
+c> coeff   1:kprim    to rcoeff   1:primprim
+            dbl_mb(k_rcoef+l-1) = dbl_mb(k_coef+m+j-1)
+c> icenter 1:nprim    to ricenter 1:primprim
+            int_mb(k_ricent+l-1) =  int_mb(k_icent+icont-1)
+            l = l + 1
+          enddo
+            n = n + 1
+        enddo
+        k = k + int_mb(k_tprim+icont-1) 
+        m = m + int_mb(k_nprim+icont-1)
+      enddo !icont
+c
+      if (.not. ma_push_get(mt_dbl,primprim*noccs,'coeffients', 
+     $                                                      l_co, k_co))
+     $    call errquit('waimfile : ma failed', primprim*noccs, MA_ERR)
+
+      naco = 0
+      do iset = 1, nset
+        do n = 1, nocc(iset)
+          call ga_get(g_vecs(iset),1, nbf,n,n,dbl_mb(k_vecs),1)
+          k = 0
+          l = 1
+          m = 0
+          do icont = 1, numcont
+            do i = 1 + k, int_mb(k_rprim+icont-1) + k
+              m = m + 1
+              do j=1,int_mb(k_nprim+icont-1) 
+c> expand eigenvector 1:nbf  to 1:primprim
+                dbl_mb(k_co + primprim*naco + l-1) = 
+     $                                      dbl_mb(k_vecs+m-1)
+c> easy human reading
+                if ( abs( dbl_mb(k_co + primprim*naco +l-1)).lt.1d-30)
+     $            dbl_mb(k_co + primprim*naco +l-1) = 0.0
+                l = l + 1
+              enddo !j
+            enddo  ! i
+            k = k + int_mb(k_tprim+icont-1) 
+          enddo !icont
+          naco = naco + 1 
+        enddo
+      enddo
+
+c> WFN files is always in catesian
+         
+      if (sphcart.eq.1) then
+         if (.not. waimfile_sph2cart( primprim, 
+     $                               noccs,
+     $                               nocc,
+     $                               nset,
+     $                               k_ritype, 
+     $                               k_icent, k_ricent,
+     $                               k_exp, k_rexp,
+     $                               k_coef,  k_rcoef,
+     $                               k_co,
+     $                               ks_rexp,ks_rcoef,
+     $                               ks_ricent,ks_ritype,
+     $                               ks_co,
+     $                               sprimprim))
+     $       call errquit('waimfile: write error wfn',0, GA_ERR)
+      endif
+
+
+cccccccccccccccccccccccccc VIRIAL THEOREM VALUES ccccccccccccccccccccc
+c
+c Recover potential energy (V) by evaluating kinetic energy (T)
+c
+c                        E_total = T + V                       
+c
+cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
+
+
+
+      if (.not. rtdb_cget(rtdb, 'task:theory', 1, theory))
+     $     call errquit('waimfile: theory not specified',555,
+     &       INPUT_ERR)
+c
+      if (.not. rtdb_get(rtdb,theory(1:inp_strlen(theory))//':energy'
+     $                                            , MT_DBL,1,etot))
+     $  etot = 0.0d0
+
+
+
+
+      if (etot.ne.0.0d0) then
+
+c>  do kinetic energy
+        call int_init(rtdb,1,basis)
+c
+        g_dens(1) = ga_create_atom_blocked(geom, basis, 'dens1')
+c
+        call ga_zero(g_dens(1))
+        call ga_dgemm('n', 't', nbf, nbf, nocc(1), 1.0d0, g_vecs(1),
+     $                                      g_vecs(1), 0.0d0, g_dens(1))
+
+        g_hcore(1)  = ga_create_atom_blocked(geom, basis,'kin')
+        call ga_zero(g_hcore(1))
+        call int_1e_ga(basis, basis, g_hcore(1), 'kinetic', .false.)
+c
+        ekin = ga_ddot(g_dens(1),g_hcore(1)) 
+c
+        if (nset.eq.2) then
+          g_dens(2) = ga_create_atom_blocked(geom, basis, 'dens2')
+          call ga_zero(g_dens(2))
+          call ga_dgemm('n', 't', nbf, nbf, nocc(2), 1.0d0, g_vecs(2),
+     $        g_vecs(2), 0.0d0, g_dens(2))
+          g_hcore(2)  = ga_create_atom_blocked(geom, basis,'kin')
+          call ga_zero(g_hcore(2))
+          call int_1e_ga(basis, basis, g_hcore(2), 'kinetic', .false.)
+c
+          ekin = ekin + ga_ddot(g_dens(2),g_hcore(2))
+          if (.not. ga_destroy(g_hcore(2)))
+     $       call errquit('waimfile: destroy g_hcore2',0, GA_ERR)
+          if (.not. ga_destroy(g_dens(2)))
+     $       call errquit('waimfile: destroy g_dens2',0, GA_ERR)
+        else
+          ekin = 2*ekin
+        endif
+
+        if (.not. ga_destroy(g_hcore(1)))
+     $       call errquit('waimfile: destroy g_hcore1',0, GA_ERR)
+        if (.not. ga_destroy(g_dens(1)))
+     $       call errquit('waimfile: destroy g_dens1',0, GA_ERR)
+c
+        epot = etot - ekin
+        virial =  abs(epot/ekin)
+c
+        if (ga_nodeid() .eq. 0) then
+          write (6,*) '             Total Energy E = ', etot
+          write (6,*) '           Kinetic Energy V = ', ekin
+          write (6,*) '         Potential Energy T = ', epot
+          write (6,*) '            Virial ABS(V/T) = ', virial
+        endif
+c
+        call int_terminate()
+      else
+        if (ga_nodeid() .eq. 0) 
+     $       write (6,*) ' Total Energy = Zero (NO FOUND)'
+          virial = 0.0d0
+      endif
+
+      call ga_sync()
+
+cccccccccccccccccccccccccc VIRIAL THEOREM VALUES end cccccccccccccccccc
+
+c> wavefunction
+
+      rhf='RHF'
+      if (nset.gt.1) rhf = 'UHF'
+
+
+ccccccccccccccccccccc   Print file   cccccccccccccccccccccccc
+c>   Print .WFN file :  waimfile_printwfn
+c>   Print .WFX file :  waimfile_printwfx
+
+      if (ga_nodeid() .eq. 0) then
+      if (sphcart.eq.1) then
+      if(nowfx) then 
+        call util_file_name('wfn', .false., .false., wfnfile)
+        if (.not. waimfile_printwfn(wfnfile,title,natoms,nset,sprimprim,
+     $              nocc,int_mb(ks_ricent),int_mb(ks_ritype),
+     $              dbl_mb(ks_co), dbl_mb(ks_co+sprimprim*nocc(1)),
+     $              dbl_mb(ks_rexp), dbl_mb(ks_rcoef),
+     $              coord,qnuc,symbol,
+     $              dbl_mb(k_occ(1)),dbl_mb(k_occ(2)),
+     $              dbl_mb(k_eval(1)),dbl_mb(k_eval(2)),
+     $              etot,virial,rhf))
+     $       call errquit('waimfile: write error wfn',0, GA_ERR)
+         else
+         call util_file_name('wfx', .false., .false., wfnfile)
+         if (.not. waimfile_printwfx( wfnfile,title,
+     $              natoms,nset,sprimprim,
+     $              nocc,int_mb(ks_ricent),int_mb(ks_ritype),
+     $              dbl_mb(ks_co), dbl_mb(ks_co+sprimprim*nocc(1)),
+     $              dbl_mb(ks_rexp), dbl_mb(ks_rcoef),
+     $              coord,qnuc,symbol,
+     $              dbl_mb(k_occ(1)),dbl_mb(k_occ(2)),
+     $              dbl_mb(k_eval(1)),dbl_mb(k_eval(2)),
+     $              etot,virial,rhf,total_charge))
+     $       call errquit('waimfile: write error wfn',0, GA_ERR)
+      endif !nowfx
+      else
+      if(nowfx) then 
+        call util_file_name('wfn', .false., .false., wfnfile)
+        if (.not. waimfile_printwfn( wfnfile,title,natoms,nset,primprim,
+     $              nocc,int_mb(k_ricent),int_mb(k_ritype),
+     $              dbl_mb(k_co), dbl_mb(k_co+primprim*nocc(1)),
+     $              dbl_mb(k_rexp), dbl_mb(k_rcoef),
+     $              coord,qnuc,symbol,
+     $              dbl_mb(k_occ(1)),dbl_mb(k_occ(2)),
+     $              dbl_mb(k_eval(1)),dbl_mb(k_eval(2)),
+     $              etot,virial,rhf))
+     $       call errquit('waimfile: write error wfn',0, GA_ERR)
+         else
+         call util_file_name('wfx', .false., .false., wfnfile)
+         if (.not. waimfile_printwfx( wfnfile,title,
+     $              natoms,nset,primprim,
+     $              nocc,int_mb(k_ricent),int_mb(k_ritype),
+     $              dbl_mb(k_co), dbl_mb(k_co+primprim*nocc(1)),
+     $              dbl_mb(k_rexp), dbl_mb(k_rcoef),
+     $              coord,qnuc,symbol,
+     $              dbl_mb(k_occ(1)),dbl_mb(k_occ(2)),
+     $              dbl_mb(k_eval(1)),dbl_mb(k_eval(2)),
+     $              etot,virial,rhf,total_charge))
+     $       call errquit('waimfile: write error wfn',0, GA_ERR)
+      endif !nowfx
+      endif !sphcart
+      endif !ga.eq.0
+
+ccccccccccccccccccccc   Print file END   cccccccccccccccccccc
+c
+
+
+      if (nset.gt.1) then
+         if (.not. ga_destroy(g_vecs(2)))
+     $       call errquit('waimfile: destroy g_movecs',0, GA_ERR)
+      endif
+
+      if (.not. ga_destroy(g_vecs(1)))
+     $       call errquit('waimfile: destroy g_movecs',0, GA_ERR)
+
+      if(.not.ma_chop_stack(l_occ(1)))
+     &   call errquit('waimfile, ma_chop_stack of l_icent failed',911,
+     &       ma_err)
+c
+c*            if (.not. geom_print(geom))
+c*     $           call errquit('property: geom_print ?',0, GEOM_ERR)
+c*            call util_flush(luout)
+c
+      if (.not.(
+     &    (bas_destroy(basis))
+     &    .and.
+     &    (geom_destroy(geom))
+     &    ))
+     &    call errquit
+     &    ('waimfile:error destroying geom and basis handles',911,
+     &       GEOM_ERR)
+c
+      return
+      end
+
+      logical function waimfile_printwfn(filename,title,natoms,
+     $                                   nset,primprim,
+     $                                   nocc,ricent,ritype,
+     $                                   coa,cob,
+     $                                   rexp,rcoef,coord,qnuc,symbol,
+     $                                   occa,occb,evala,evalb,
+     $                                   etot, virial,rhf)
+      implicit none
+      character*80 filename !in
+      character*80 title !in
+      integer natoms
+      integer iset,nset
+      integer primprim
+      integer nocc(2)
+      integer ricent(primprim), ritype(primprim)
+      integer i,j
+      integer naco
+      double precision rexp(primprim),rcoef(primprim)
+      double precision coord(3,natoms), qnuc(natoms)
+      double precision coa(primprim,nocc(1)),cob(primprim,nocc(2))
+      character*4 symbol(natoms)
+      double precision occa(*), occb(*)
+      double precision evala(*), evalb(*)
+      double precision etot, virial
+      character*16 rhf
+c
+      integer unitno
+      parameter (unitno = 38)
+
+      waimfile_printwfn=.false.
+      write(6,*) '   Name of Final wnf-file  ', filename
+cc
+      open(unit=unitno, file=filename, status='unknown',
+     &       form='formatted')
+
+      write(unitno,1001) title(1:80)
+      write(unitno,1002) nocc(1)+nocc(2),primprim,natoms
+ccc write geometry
+      write(unitno,1003) (symbol(i),i, i,
+     $                      coord(1,i),coord(2,i),coord(3,i),
+     $                      qnuc(i),i=1,natoms)
+      write(unitno,1004) (ricent(i),i=1,primprim)
+      write(unitno,1005) (ritype(i),i=1,primprim)
+      write(unitno,1006) (rexp(i),  i=1,primprim)
+c
+c>>occupation and orb. ener.
+c>>coeff X eigenvec
+      naco=1
+      do i = 1, nocc(1)
+        write(unitno,1007) i,occa(i),evala(i)
+        write(unitno,1008) (coa(j,naco) *rcoef(j),j=1, primprim) 
+        naco = naco + 1
+      enddo
+      if(nset.eq.2) then 
+        naco=1
+        do i = 1, nocc(2)
+           write(unitno,1007) i,occb(i),evalb(i)
+           write(unitno,1008) (cob(j,naco) *rcoef(j),j=1, primprim) 
+           naco = naco + 1
+        enddo
+      endif
+
+c>>end message
+      write(unitno,1009) 
+c>> restricted or unretricted banner
+      write(unitno,1010) rhf,etot, virial
+c
+      close(unit=unitno, status='keep')
+
+      waimfile_printwfn=.true.
+
+ccc>>>>> WFN Format  <<<<<<<<<<<<<<<<<<<
+ 1001 format (1A80)
+ 1002 format ('GAUSSIAN',10X,I5,' MOL ORBITALS',1X,I6,' PRIMITIVES',
+     &                                                4X,I5,' NUCLEI')
+ 1003 format (A4,I4,4X,'(CENTRE',I3,')',1X,3F12.8,'  CHARGE =',F5.1)
+ 1004 format ('CENTRE ASSIGNMENTS',2X,20I3)
+ 1005 format ('TYPE ASSIGNMENTS',4X,20I3)
+ 1006 format ('EXPONENTS',1X,1P,5E14.7)
+ 1007 format ('MO',I3,21X,'OCC NO = ',F12.8,' ORB. ENERGY =',F13.8 )
+ 1008 format (1P,5E16.8)
+ 1009 format ('END DATA')
+ 1010 format (A8,' ENERGY =',F20.10,'   VIRIAL(-V/T)  =',F13.8)
+ccc>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
+      end
+      logical function waimfile_printwfx(filename,title,natoms,
+     $                                   nset,primprim,
+     $                                   nocc,ricent,ritype,
+     $                                   coa,cob,
+     $                                   rexp,rcoef,coord,qnuc,symbol,
+     $                                   occa,occb,evala,evalb,
+     $                                   etot, virial,rhf,total_charge)
+      implicit none
+      character*80 filename !in
+      character*80 title !in
+      integer natoms
+      integer iset,nset
+      integer primprim
+      integer nocc(2)
+      integer ricent(primprim), ritype(primprim)
+      integer i,j
+      integer naco
+      double precision rexp(primprim),rcoef(primprim)
+      double precision coord(3,natoms), qnuc(natoms)
+      double precision coa(primprim,nocc(1)),cob(primprim,nocc(2))
+      character*4 symbol(natoms)
+      character*30 string_var
+      double precision occa(*), occb(*)
+      double precision evala(*), evalb(*)
+      double precision etot, virial
+      double precision total_charge
+      character*16 rhf
+c
+      integer unitno
+      parameter (unitno = 38)
+
+      waimfile_printwfx=.false.
+
+
+      write(6,*) '   Name of Final wnf-file  ', filename
+c
+      open(unit=unitno, file=filename, status='unknown',
+     &     form='formatted')
+
+      write(unitno,2001) title(1:80)
+      write(unitno,2004) ' GTO' 
+      write(unitno,2007) natoms
+      write(unitno,2010) nocc(1)+nocc(2)
+      write(unitno,2013) 0
+      if (nset.eq.1) then
+          total_charge=total_charge-2*nocc(1)        
+          write(unitno,2016) total_charge
+      else
+          total_charge=total_charge-(nocc(1)+nocc(2))
+          write(unitno,2016) total_charge
+      endif
+      if (nset.eq.1) then
+          write(unitno,2019) 2*nocc(1)
+          write(unitno,2022) nocc(1)
+          write(unitno,2025) nocc(1)
+          i = 1
+          write(unitno,2028) i  
+      else
+          write(unitno,2019) nocc(1)+nocc(2)
+          write(unitno,2022) nocc(1)
+          write(unitno,2025) nocc(2)
+          write(unitno,2028) (nocc(1)-nocc(2))+1
+      endif 
+      write(unitno,2031) 0
+
+c write geometry
+      write(unitno,2034)
+      do i=1,natoms
+        write(string_var, '(I30)') i
+        write(unitno,2035) symbol(i),adjustl(string_var)
+      enddo
+      write(unitno,2036)
+
+      write(unitno,2037)
+      write(unitno,2038) (int(qnuc(i)),i=1,natoms)
+      write(unitno,2039)
+
+      write(unitno,2040)
+      write(unitno,2041) (qnuc(i),i=1,natoms)
+      write(unitno,2042)
+      
+      write(unitno,2043)
+      write(unitno,2044) (coord(1,i),coord(2,i),coord(3,i),
+     $                                            i=1,natoms)
+
+      write(unitno,2045)
+      write(unitno,2046)
+      write(unitno,2047) primprim
+      write(unitno,2048)
+      write(unitno,2049)
+      write(unitno,2050) (ricent(i),i=1,primprim)
+      write(unitno,2051)
+      write(unitno,2052)
+      write(unitno,2050) (ritype(i),i=1,primprim)
+      write(unitno,2053)
+      write(unitno,2054)
+      write(unitno,2055) (rexp(i),  i=1,primprim)
+      write(unitno,2056)
+
+
+c>>Occupation Numbers
+      write(unitno,2057)    
+      write(unitno,2041) (occa(i),i=1,nocc(1))
+      if(nset.eq.2) write(unitno,2041) (occb(i),i=1,nocc(2))
+      write(unitno,2058)
+c Orbital Energies
+      write(unitno,2059)
+      write(unitno,2041) (evala(i),i=1,nocc(1))
+      if(nset.eq.2) write(unitno,2041) (evalb(i),i=1,nocc(2))
+      write(unitno,2060)
+c Orbital types
+      write(unitno,2061)
+      if (nset.eq.1) then
+         do i = 1,nocc(1)
+         write(unitno,2062)
+           enddo
+      else
+        do i = 1,nocc(1)
+         write(unitno,2063)
+        enddo
+        do i = 1,nocc(2)
+         write(unitno,2064)
+        enddo 
+      endif
+      write(unitno,2065)   
+
+      write(unitno,2066)
+      naco = 1
+      do i = 1, nocc(1)
+         write(unitno,2067)
+         write(unitno,2047) i
+         write(unitno,2068)
+         write(unitno,2069) (coa(j,naco) *rcoef(j),j=1, primprim) 
+         naco = naco + 1
+      enddo
+      if (nset.eq.2) then 
+        do i = 1, nocc(1)
+           write(unitno,2067)
+           write(unitno,2047) i+nocc(1)
+           write(unitno,2068)
+           write(unitno,2069) (coa(j,naco) *rcoef(j),j=1, primprim) 
+           naco = naco + 1
+        enddo
+      endif
+      write(unitno,2070)
+cEnergy print
+      write(unitno,2071)
+      write(unitno,2041) etot
+      write(unitno,2072)
+cVirial print
+      write(unitno,2073)
+      write(unitno,2041) virial
+      write(unitno,2074)
+
+      if (nset.eq.1) then 
+        write(unitno,2075) 'Restricted SCF'
+      else
+        write(unitno,2075) 'Unrestricted SCF'
+      endif
+
+      close(unit=unitno, status='keep')
+
+      waimfile_printwfx=.true.
+
+
+
+c>>>> WFX Format  <<<<<<<<<<<<<<<<
+
+ 2001 format ('<Title>',/,1A80,/,'</Title>',/)
+
+ 2004 format ('<Keywords>',/,1A5,/,'</Keywords>',/)
+
+ 2007 format ('<Number of Nuclei>',/,I5,/,'</Number of Nuclei>',/)
+
+ 2010 format ('<Number of Occupied Molecular Orbitals>',/,I5,/,
+     $        '</Number of Occupied Molecular Orbitals>',/)
+
+ 2013 format ('<Number of Perturbations>',/,I2,/,
+     $       ' </Number of Perturbations>',/)
+
+ 2016 format ('<Net Charge>',/,F5.2,/,'</Net Charge>',/)
+
+ 2019 format ('<Number of Electrons>',/,I3,/,'</Number of Electrons>',/)
+
+ 2022 format ('<Number of Alpha Electrons>',/,I5,/,
+     $        '</Number of Alpha Electrons>',/)
+
+ 2025 format ('<Number of Beta Electrons>',/,I5,/,
+     $        '</Number of Beta Electrons>',/)
+
+ 2028 format ('<Electronic Spin Multiplicity>',/,I5,/,
+     $         '</Electronic Spin Multiplicity>',/)
+
+ 2031 format ('<Number of Core Electrons>',/,I5,/,
+     $        '</Number of Core Electrons>',/)
+
+ 2034 format ('<Nuclear Names>')
+ 2035 format (A3,A30)
+ 2036 format ('</Nuclear Names>',/)
+
+ 2037 format ('<Atomic Numbers>')
+ 2038 format (I3)
+ 2039 format ('</Atomic Numbers>',/)
+
+ 2040 format ('<Nuclear Charges>')
+ 2041 format (E20.12)
+ 2042 format ('</Nuclear Charges>',/)
+
+ 2043 format ('<Nuclear Cartesian Coordinates>')
+ 2044 format (1X,3E20.12)
+ 2045 format ('</Nuclear Cartesian Coordinates>',/)
+
+ 2046 format ('<Number of Primitives>')
+ 2047 format (I5)
+ 2048 format ('</Number of Primitives>',/)
+
+ 2049 format ('<Primitive Centers>')
+ 2050 format (5I20)
+ 2051 format ('</Primitive Centers>',/)
+
+ 2052 format ('<Primitive Types>')
+ 2053 format ('</Primitive Types>',/)
+
+ 2054 format ('<Primitive Exponents>')
+ 2055 format (5E20.12)
+ 2056 format ('</Primitive Exponents>',/)
+
+ 2057 format ('<Molecular Orbital Occupation Numbers>')
+ 2058 format ('</Molecular Orbital Occupation Numbers>',/)
+
+ 2059 format ('<Molecular Orbital Energies>')
+ 2060 format ('</Molecular Orbital Energies>',/)
+
+ 2061 format ('<Molecular Orbital Spin Types>')
+ 2062 format (' Alpha and Beta')
+ 2063 format (' Alpha')
+ 2064 format (' Beta')
+ 2065 format ('</Molecular Orbital Spin Types>',/)
+
+ 2066 format ('<Molecular Orbital Primitive Coefficients>')
+ 2067 format ('<MO Number>')
+ 2068 format ('</MO Number>',/)
+ 2069 format (4E20.12)
+ 2070 format ('</Molecular Orbital Primitive Coefficients>',/)
+
+ 2071 format ('<Energy = T + Vne + Vee + Vnn>')
+ 2072 format ('</Energy = T + Vne + Vee + Vnn>',/)
+
+ 2073 format ('<Virial Ratio (-V/T)>')
+ 2074 format ('</Virial Ratio (-V/T)>',/)
+
+ 2075 format ('<Model>',/,1A80,/,'</Model>',/)
+
+      end
+      logical function waimfile_sph2cart( primprim, 
+     $                                   noccs,
+     $                                   nocc,
+     $                                   nset,
+     $                                   k_ritype, 
+     $                                   k_icent, k_ricent,
+     $                                   k_exp, k_rexp,
+     $                                   k_coef,  k_rcoef,
+     $                                   k_co,
+     $                                   ks_rexp,ks_rcoef,
+     $                                   ks_ricent,ks_ritype,
+     $                                   ks_co,
+     $                                   sprimprim) 
+      implicit none
+#include "mafdecls.fh"
+#include "errquit.fh"
+      integer primprim
+      integer sprimprim
+      integer nset,iset
+      integer numd,numf,numg,numh
+      integer  noccs, nocc(2)
+      integer  k_icent, k_ricent
+      integer k_ritype
+      integer k_exp, k_rexp
+      integer k_coef,  k_rcoef 
+      integer k_co 
+      integer ls_co, ks_co
+      integer ls_ritype, ks_ritype
+      integer ls_ricent, ks_ricent
+      integer ls_rexp, ks_rexp
+      integer ls_rcoef, ks_rcoef
+      integer i,j,k,l,n,r,h,m,t
+      integer np,iorb,forb,nsf
+      integer naco
+      double precision sqrt3, sqrt5, sqrt7, DUMMY
+c:
+c: author A. Guevara 7/2013
+c:
+      waimfile_sph2cart=.false.
+
+      !sqrt3=1.7320508076D+00
+      sqrt3=3.0**(1.0/3.0)
+        
+      numd=0
+      numf=0
+      numg=0
+      numh=0
+      do i = 0,primprim-1
+         if (int_mb(k_ritype+i).eq.5) numd=numd+1
+         if (int_mb(k_ritype+i).eq.10) numf=numf+1
+         if (int_mb(k_ritype+i).eq.17) numg=numg+1
+         if (int_mb(k_ritype+i).eq.26) numh=numh+1
+      enddo
+      sprimprim=primprim+numd+3*numf+6*numg+10*numh 
+      if (.not. ma_push_get(mt_dbl,sprimprim,'rexponents',
+     $                                       ls_rexp, ks_rexp))
+     $ call errquit('waimfile_sph2cart : ma failed exp', 
+     $                                         sprimprim, MA_ERR)
+      if (.not. ma_push_get(mt_dbl,sprimprim,'rcoefficients',
+     $                                     ls_rcoef, ks_rcoef))
+     $call errquit('waimfile_sph2cart : ma failed exp',
+     $                                         sprimprim, MA_ERR)
+      if (.not. ma_push_get(mt_int,sprimprim,'ricent',
+     $                                     ls_ricent,ks_ricent))
+     &call errquit('waimfile_sph2cart : failed icent.',sprimprim,MA_ERR)
+      if (.not. ma_push_get(mt_int,sprimprim,'ritype',
+     $                                      ls_ritype,ks_ritype))
+     & call errquit('waimfile_sph2cart : failed itype.',
+     $                                         sprimprim, MA_ERR)
+
+
+      if (.not. ma_push_get(mt_dbl,sprimprim*noccs,'coeffients',
+     $                                                 ls_co, ks_co))
+     $    call errquit('waimfile : ma failed ls coeff', 
+     $                                        sprimprim*noccs, MA_ERR)
+
+      i=0
+      t=0
+      do while (i<primprim)
+        if ( (int_mb(k_ritype +i).eq.5)  .or.
+     $       (int_mb(k_ritype +i).eq.10) .or. 
+     $       (int_mb(k_ritype +i).eq.17) .or.
+     $       (int_mb(k_ritype +i).eq.26)) then
+
+           if (int_mb(k_ritype +i).eq.5) then
+              iorb=5
+              forb=10
+              nsf=5
+           elseif (int_mb(k_ritype +i).eq.10) then
+              iorb=11
+              forb=20
+              nsf=7
+           else if (int_mb(k_ritype +i).eq.17) then
+              iorb=21
+              forb=35
+              nsf=9
+           else if (int_mb(k_ritype +i).eq.26) then
+              iorb=36
+              forb=56
+              nsf=11
+           endif 
+           j=i+1
+           np=1
+           do while (int_mb(k_ritype +i).eq.int_mb(k_ritype +j))
+              np=np+1
+              j=j+1
+           enddo
+           do l=iorb,forb
+              k=0
+              do while (k<np)
+                 int_mb(ks_ritype +t+k)=l
+                 int_mb(ks_ricent +t+k)=int_mb(k_ricent +i)
+                 dbl_mb(ks_rexp+t+k)=dbl_mb(k_rexp +i+k)
+                 dbl_mb(ks_rcoef+t+k)=dbl_mb(k_rcoef+i+k)
+                 k=k+1
+              enddo
+              t=np+t
+           enddo
+           i=i+nsf*np
+        else
+          int_mb(ks_ritype +t)=int_mb(k_ritype +i)
+          int_mb(ks_ricent +t)=int_mb(k_ricent +i)
+          dbl_mb(ks_rexp+t)=dbl_mb(k_rexp +i)
+          dbl_mb(ks_rcoef+t)=dbl_mb(k_rcoef+i)          
+          i=i+1            
+          t=t+1
+        endif!k_ritype
+      enddo !primprim
+
+
+
+      naco = 0
+      do iset = 1,nset
+      do m = 1, nocc(iset)
+      i=0
+      t=0
+      do while (i<primprim)
+          if ( (int_mb(k_ritype +i).eq.5)  .or.
+     $         (int_mb(k_ritype +i).eq.10) .or.
+     $         (int_mb(k_ritype +i).eq.17) .or.
+     $         (int_mb(k_ritype +i).eq.26)) then
+c d functions
+            if (int_mb(k_ritype +i).eq.5) then
+               iorb=1
+               forb=6
+               nsf=5
+                j=i+1
+                np=1
+                do while (int_mb(k_ritype +i).eq.int_mb(k_ritype +j))
+                   np=np+1
+                   j=j+1
+                enddo 
+                do l = iorb,forb 
+                   k=0
+                   do while (k<np)
+                      if (l.eq.1) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                  -0.5*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           +8.6602540378D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                      elseif (l.eq.2) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                  -0.5*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           -8.6602540378D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                      elseif (l.eq.3) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                    dbl_mb(k_co+primprim*naco+i+k+2*np)
+                      elseif (l.eq.4) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                    sqrt3*dbl_mb(k_co+primprim*naco+i+k)
+                      elseif (l.eq.5) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                   -sqrt3*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                      elseif (l.eq.6) then
+                        dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                    sqrt3*dbl_mb(k_co+primprim*naco+i+k+np)
+                      endif
+                      k=k+1
+                   enddo
+                   t=np+t
+                enddo
+                i=i+nsf*np
+c d functions
+c f functions
+            else if (int_mb(k_ritype +i).eq.10) then
+               iorb=1
+               forb=10
+               nsf=7
+                j=i+1
+                np=1
+                do while (int_mb(k_ritype +i).eq.int_mb(k_ritype +j))
+                  np=np+1
+                  j=j+1
+                enddo
+                do l = iorb,forb
+                  k=0
+                  do while (k<np)
+                    if (l.eq.1) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           6.1237243570D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $           -7.9056941504D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+                    else if (l.eq.2) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -7.9056941504D-01*dbl_mb(k_co+primprim*naco+i+k)
+     $           -6.1237243570D-01*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    else if (l.eq.3) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $                dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.4) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k)
+     $           -6.1237243570D-01*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    else if (l.eq.5) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -1.5000000000D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+     $           +1.9364916731D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+                    else if (l.eq.6) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -1.5000000000D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+     $           -1.9364916731D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+                    else if (l.eq.7) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           6.1237243570D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $           +2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+                    else if (l.eq.8) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -2.4494897428D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.9) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           2.4494897428D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    else if (l.eq.10) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           3.8729833462D+00*dbl_mb(k_co+primprim*naco+i+k+1*np)   
+                    endif
+                    k=k+1
+                  enddo!k
+                  t=np+t
+                enddo !l
+                i=i+nsf*np
+c f functions
+c g funtions
+            else if (int_mb(k_ritype +i).eq.17) then
+               iorb=1
+               forb=15
+               nsf=9
+               j=i+1
+               np=1
+               do while (int_mb(k_ritype +i).eq.int_mb(k_ritype +j))
+                  np=np+1
+                  j=j+1
+               enddo
+               do l = iorb,forb
+                 k=0
+                 do while (k<np)
+                    if (l.eq.1) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         3.7500000000D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $         -5.5901699437D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $         +7.3950997289D-01*dbl_mb(k_co+primprim*naco+i+k+8*np)
+                    else if (l.eq.2) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         3.7500000000D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $         +5.5901699437D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $         +7.3950997289D-01*dbl_mb(k_co+primprim*naco+i+k+8*np)
+                    else if (l.eq.3) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $              dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.4) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         2.9580398915D+00*dbl_mb(k_co+primprim*naco+i+k)
+     $         -1.1180339887D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    else if (l.eq.5) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $         -2.0916500663D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+                    else if (l.eq.6) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         -2.9580398915D+00*dbl_mb(k_co+primprim*naco+i+k)
+     $         -1.1180339887D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    else if (l.eq.7) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         -2.0916500663D+00*dbl_mb(k_co+primprim*naco+i+k+np)
+     $         -2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.8) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         -3.1622776602D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+                    else if (l.eq.9) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         3.1622776602D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.10) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         7.5000000000D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $         -4.4370598373D+00*dbl_mb(k_co+primprim*naco+i+k+8*np)
+                    else if (l.eq.11) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         -3.0000000000D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $         +3.3541019662D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+                    else if (l.eq.12) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         -3.0000000000D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+     $         -3.3541019662D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+                    else if (l.eq.13) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         6.2749501990D+00*dbl_mb(k_co+primprim*naco+i+k+1*np)
+     $         -2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.14) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         2.3717082451D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $         +6.2749501990D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+                    else if (l.eq.15) then
+                    dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $         6.7082039325D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+                    endif
+                    k=k+1
+                 enddo
+                 t=np+t
+               enddo
+               i=i+nsf*np
+c g functions
+c h functions
+            else if (int_mb(k_ritype +i).eq.26) then
+               iorb=1
+               forb=21
+               nsf=11
+               j=i+1
+               np=1
+               do while (int_mb(k_ritype +i).eq.int_mb(k_ritype +j))
+                 np=np+1
+                 j=j+1
+               enddo
+               do l = iorb,forb
+                 k=0
+                 do while (k<np)
+                   if (l.eq.1) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           dbl_mb(k_co+primprim*naco+i+k+5*np)
+                    else if (l.eq.2) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           3.8729833462D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.3) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -5.0000000000D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $           -5.1234753830D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+                    else if (l.eq.4) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -4.1833001327D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           -5.8094750193D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.5) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           1.8750000000D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $           +2.5617376915D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+     $           +2.2185299187D+00*dbl_mb(k_co+primprim*naco+i+k+9*np)
+                    else if (l.eq.6) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           7.0156076002D-01*dbl_mb(k_co+primprim*naco+i+k)
+     $           +5.2291251658D-01*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           +4.8412291828D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.7) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -3.8729833462D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+                    else if (l.eq.8) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           1.0246950766D+01*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.9) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           5.8094750193D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $           +1.2549900398D+01*dbl_mb(k_co+primprim*naco+i+k+8*np)
+                    else if (l.eq.10) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -8.8741196746D+00*dbl_mb(k_co+primprim*naco+i+k+1*np)
+     $           -5.1234753830D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.11) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -4.8412291828D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $           -1.5687375498D+00*dbl_mb(k_co+primprim*naco+i+k+8*np)
+     $           -3.5078038001D+00*dbl_mb(k_co+primprim*naco+i+k+10*np)
+                    else if (l.eq.12) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -5.0000000000D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $           +5.1234753830D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+                    else if (l.eq.13) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           1.2549900398D+01*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           -5.8094750193D+00*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.14) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           3.7500000000D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $           -1.3311179512D+01*dbl_mb(k_co+primprim*naco+i+k+9*np)
+                    else if (l.eq.15) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -7.0156076002D+00*dbl_mb(k_co+primprim*naco+i+k)
+     $           -1.0458250332D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           +9.6824583655D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.16) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           5.8094750193D+00*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $           -4.1833001327D+00*dbl_mb(k_co+primprim*naco+i+k+8*np)
+                    else if (l.eq.17) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           8.8741196746D+00*dbl_mb(k_co+primprim*naco+i+k+1*np)
+     $           -5.1234753830D+00*dbl_mb(k_co+primprim*naco+i+k+3*np)
+                    else if (l.eq.18) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -9.6824583655D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $           -1.0458250332D+00*dbl_mb(k_co+primprim*naco+i+k+8*np)
+     $           +7.0156076002D+00*dbl_mb(k_co+primprim*naco+i+k+10*np)
+                    else if (l.eq.19) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           1.8750000000D+00*dbl_mb(k_co+primprim*naco+i+k+5*np)
+     $           -2.5617376915D+00*dbl_mb(k_co+primprim*naco+i+k+7*np)
+     $           +2.2185299187D+00*dbl_mb(k_co+primprim*naco+i+k+9*np)
+                    else if (l.eq.20) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           3.5078038001D+00*dbl_mb(k_co+primprim*naco+i+k)
+     $           -1.5687375498D+00*dbl_mb(k_co+primprim*naco+i+k+2*np)
+     $           +4.8412291828D-01*dbl_mb(k_co+primprim*naco+i+k+4*np)
+                    else if (l.eq.21) then
+                      dbl_mb(ks_co+sprimprim*naco+t+k)=
+     $           -4.8412291828D-01*dbl_mb(k_co+primprim*naco+i+k+6*np)
+     $           +5.2291251658D-01*dbl_mb(k_co+primprim*naco+i+k+8*np)
+     $           -7.0156076002D-01*dbl_mb(k_co+primprim*naco+i+k+10*np)
+                    endif
+                    k=k+1
+                  enddo
+                  t=np+t
+                enddo
+                i=i+nsf*np
+c h functions
+            endif
+            else
+            dbl_mb(ks_co+sprimprim*naco+t)=
+     $                   dbl_mb(k_co+primprim*naco+i)
+            i=i+1
+            t=t+1
+            endif!k
+        enddo !i
+        naco = naco + 1
+      enddo !m
+      enddo !iset
+
+      waimfile_sph2cart=.true.
+
+      end
+cgraveyardc      character*3 atmsymbol(nelements)
+cgraveyardc      data atmsymbol/'  H',' He',' Li','  Be','  B','  C',
+cgraveyardc     *               '  N','  O','  F','  Ne','  Na','  Mg',
+cgraveyardc     *               ' Al',' Si','  P','  S','  Cl',' Ar',
+cgraveyardc     *               '  K',' Ca',' Sc',' Ti','  V',' Cr',
+cgraveyardc     *               ' Mn',' Fe',' Co',' Ni',' Cu',' Zn',
+cgraveyardc     *               ' Ga',' Ge',' As',' Se',' Br',' Kr',
+cgraveyardc     *               ' Rb',' Sr','  Y',' Zr',' Nb',' Mo',
+cgraveyardc     *               ' Tc',' Ru',' Rh',' Pd',' Ag',' Cd',
+cgraveyardc     *               ' In',' Sn',' Sb',' Te','  I',' Xe',
+cgraveyardc     *               ' Cs',' Ba',' La',' Ce',' Pr',' Nd',
+cgraveyardc     *               ' Pm',' Sm',' Eu',' Gd',' Tb',' Dy',
+cgraveyardc     *               ' Ho',' Er',' Tm',' Yb',' Lu',' Hf',
+cgraveyardc     *               ' Ta','  W',' Re',' Os',' Ir',' Pt',
+cgraveyardc     *               ' Au',' Hg',' Tl',' Pb',' Bi',' Po',
+cgraveyardc     *               ' At',' Rn',' Fr',' Ra',' Ac',' Th',
+cgraveyardc     *               ' P','  U',' Np',' Pu',' Am','  Cm',
+cgraveyardc     *               ' Bk',' Cf',' Es',' Fm',' Md',' No',
+cgraveyardc     *               ' Lr',' Rf',' Db',' Sg',' Bh',' Hs', 
+cgraveyardc     *               ' MT',' Ds',' Rg'/
+cgraveyard
+cgraveyardc
+cgraveyardc itypes
+cgraveyardc     /'l','s', 'p', 'd', 'f', 'g', 'h', 'i', 'k'/
+cgraveyardc      -1   0    1    2    3    4    5
