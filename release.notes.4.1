NWChem Version 4.1 Release Notes
(Also available at 
http://www.emsl.pnl.gov/pub/docs/nwchem/support/release.4.1.html)

NOTE: These release notes are not a substitute for reading the User Manual!
They are meant to give a thumbnail sketch of the new capabilities and bug
fixes that are available in NWChem Version 4.1. When there is a conflict
between the release notes and the User Manual, the User Manual takes
precedence. 

The changes for version 4.1 are listed at the bottom of this file.

Several new major capabilities are available in NWChem, including several new
modules. The new modules are: 

  o HESSIAN: This module controls the analytic hessian calculation.
  o DIRDYVTST: The DIRect Dynamics for Variational Transition State Theory.
  o BAND: Prototype Band structure code.

For each of these capabilities, the user is referred to the User
Manual for more information. 

Additional major additions to the capabilities include: 

  o The AUTOSYM directive in the GEOMETRY group is now ON by default, except
    for atoms.
  o Third order Douglas-Kroll from Kimihiko Hirao's group at the University
    of Tokyo.
  o NBO 5.0 is now available.
  o A limited memory BFGS minimization has been added to the PSPW code.
  o New density functionals, B97-2, HCTC P1/4 and OPTX have been added.
  o A robust algorithm of eliminating linear dependence in basis functions
    has been implemented in DFT.
  o A new SCF convergence scheme based on fractional occupation numbers has
    been implemented in DFT (with keyword SMEAR).
  o Charge density fitting calculations has improved performance.
  o Wildcard "*" can be used in basis set, ECP, SO basis set input.
  o Input for the PSPW module is more "user-friendly".

Again, for each of these capabilities, the user is referred to the User Manual 
for more information. 

Listed below are the other major and many minor changes for each module
with significant changes. These descriptions are somewhat terse and more
information is generally available in the User Manual. 

Note: Due to changes in the runtime database structure, RESTART
will not work on database files generated by NWChem versions 4.0.1 and 
older.

Top level directives:

  o BUG FIX: Problems on some platforms with a title longer than 80
    characters has been fixed.
  o BUG FIX: TASK SHELL now returns properly for DECOSF.

Initial orbital Guess: 

  o Maximum number of fragment systems has been increased to 60.

Basis Sets: 

  o The "*" tag is introduced in the basis set input block to increase the user
    flexibility and ease when creating the basis set input. When a star tag is 
    used the code will use the geometry and assign the basis set defined
    at the star tag line to all atoms in the geometry. In addition an "except" 
    keyword is introduced. Other new tags possible are bq* and <tag string>*.
  o Basis set library file has been split into one file per basis set to allow
    for easier access. These files are located in the directory "libraries".
  o Blanks (spaces) in basis set names have been replaced by underscores.
  o BUG FIX: An error in Ne DGauss_A1_DFT_Exchange_Fitting has been corrected. 

Geometry: 

  o The AUTOSYM directive has been improved and is now ON by default, except
    for atoms.
  o BUG FIX: AUTOSYM now uses tags instead of nuclear charges to judge
    symmetrical equivalence of atoms.
  o BUG FIX: Geometries with collinear atoms are now detected and processed 
    correctly.
  o BUG FIX: Overflow problem during the determination of rotational axes
    has been fixed.
  o BUG FIX: AUTOSYM now works for Ih and Oh symmetries.

DFT: 

  o New density functionals, B97-2, HCTC P1/4 and OPTX, have been added.
  o A robust algorithm of eliminating linear dependence in basis functions
    has been implemented.
  o A new SCF convergence scheme based on fractional occupation numbers has
    been implemented (with keyword SMEAR).
  o Charge density fitting calculations has improved performance.
  o The default value of the Schwartz screening tolerance has been raised from
    1E-10 to 1E-8 (accCoul = 8).
  o Threshold for level shifting has been decreased from 0.05 to 0.01.
  o Symmetry can be turned on and off in Lebedev grids via keywords SYMM and 
    NOSYMM.
  o Spatial symmetry breaking of orbitals for open-shell systems is checked.
  o BUG FIX: Problems with reusing a quadrature grid have been fixed.
  o BUG FIX: Restart problem when linear dependence in the basis functions is
    present has been fixed.
  o BUG FIX: DFT open-shell calculations with the exchange functions xpbe96
    and xperdew91 now give correct gradients.
  o BUG FIX: Restart calculations now work under NQE or NQS.
  o BUG FIX: DFT calculations now work when the molecule contains ghost atoms.
  o BUG FIX: Bug introduced in 4.0.1 which produced nonsense numbers for
    very large SCF and DFT calculations has been fixed.
  o BUG FIX: Convergence of COSMO for UDFT has been improved.
  o BUG FIX: Problems with negative electron density and other unstable 
    floating-point operations in some density functionals have been fixed.
  o BUG FIX: LOCK keyword (in VECTOR directive) will now work.
  o KNOWN PROBLEM: In a sequence of calculations in one input deck (using
    the same geometry and basis set) if the Hamiltonian gets changed (by
    adding relativistic operators or COSMO) in the subsequent calculation
    the vectors are assumed to be converged. This is not correct as the 
    Hamiltonian changed. 
  o KNOWN PROBLEM: In a sequence of calculations in one input deck (using
    the same geometry and basis set) if the Hamiltonian gets changed (by
    adding relativistic operators or COSMO) in the subsequent calculation
    the vectors are assumed to be converged. This is not correct as the 
    Hamiltonian changed. 

SCF: 

  o BUG FIX: Bug introduced in 4.0.1 which produced nonsense numbers for
    very large SCF and DFT calculations has been fixed.
  o KNOWN PROBLEM: In a sequence of calculations in one input deck (using
    the same geometry and basis set) if the Hamiltonian gets changed (by
    adding relativistic operators or COSMO) in the subsequent calculation
    the vectors are assumed to be converged. This is not correct as the 
    Hamiltonian changed. 

COSMO:
  
  o By default, induced charges will not be re-scaled (ifscrn = 2).
  o BUG FIX: Make COSMO gradients will now always be computed numerically.
  o KNOWN PROBLEM: No ECP can be used with COSMO.
  o KNOWN PROBLEM: No spherical Gaussian basis set can be used with COSMO.

Driver: 

  o BUG FIX: Insufficient internal variable errors have been minimized.

Properties: 

  o BUG FIX: Segmentation violations in large property calculations have been
    fixed.
  o BUG FIX: SIGFPE problems on Linux have been fixed.
  o KNOWN PROBLEM: Electrostatic potential (ESP) not available for UHF.

MP2: 

  o Singlet and triplet pair contributions to MP2 correlation energies are
    now printed separately. 
  o BUG FIX: Problem with numerical gradients for direct MP2 energies has been
    fixed.

MCSCF:

  o BUG FIX: bgj_get_scf_method error has been eliminated.

Hessian and Frequencies: 

  o BUG FIX: ANIMATE directive is now processed correctly.

PSPW:

  o Improved user interface.
  o Conjugate gradient optimization has been improved.
  o Pseudopotential library.
  o Automated pseudopotential formatting.
  o Automated wavefunction initial guess, now with LCAO.
  o Automated conversion between small and large plane-wave expansions.
  o Fixed atoms in cartesian and SHAKE constraints in Car-Parrinello.
  o Polarization through the use of point charges.
  o DPLOT available during Car-Parrinello simulations.
  o BUG FIX: Ewald sum for irregular shaped unit cells is now correct.

Prepare:

  o Default force field changed to AMBER99
  o New potential of mean force options, e.g. including bias correction, 
    constraint contributions, definitions in terms of centers of geometry, 
    automatic application of alignment pmf to each equivalent molecules, 
    automatic application of xy-plane pmf to all equivalent atoms
  o Repeat option in PDB export, including inversion, randomization
  o Number of database levels increased from 4 to 6

MD: 

  o Recording to trajectory file of forces, induced dipoles
  o History recorded on restart file
  o System collapse option
  o Additional properties: e.g. radius of gyration, moment of inertia

Analysis:

  o Analysis options for groups of atoms: bond, angle, torsion
  o Automatic rotation option for POV trajectory files

QM/MM:

  o New link atom treatment
  o New options for Bq treatment link atom neighbor atoms

Integral changes: 

  o Third-order Douglas-Kroll (DK3) integrals have been added.
  o Default value for integral screening threshold (tol2e) has been raised from
    1E-10 to 1E-8.
  o Texas integral routine will be invoked in DFT.
  o Texas integral routine will be invoked for three-center electron-repulsion
    integrals evaluation.
  o BUG FIX: An error in the transformation from Cartesian to
    spherical  Gaussian basis of integral second derivatives has been fixed.

Effective core potentials:

  o ECP integral evaluation has been accelerated by virtue of spatial symmetry.
  o BUG FIX: Wrong numbers of core electrons in LANL2DZ ECP have been 
    corrected.
  o BUG FIX: Unstable floating-point operations have been removed.

Relativistic:
 
  o Various levels of third-order Douglas-Kroll have been added.
  o BUG FIX: Spin-orbit gradient crashes have been fixed.

DPLOT:

  o DPLOT available during Car-Parrinello simulations.
  o BUG FIX: Vectors directive now picks up the vectors correctly.
  o BUG FIX: Negative spin densities are now correctly calculated for
    DFT wavefunctions.

PYTHON:

  o A python script that generates Coulomb fitting basis sets for atoms, 
    diatomic hydride and fluoride molecules has been added.

Tests, manuals and miscellaneous script changes: 

  o Updated User's Manual to reflect new and modified functionality in
    NWChem. 
  o QA tests have been updated to reflect the new functionality.
  o The program contrib/hessian/makerestart has been added to create the
    *.fdrst file from the *.hessian and *.fd_ddipole files for numerical
    hessian restarts.
  o The amount of memory (in MB) per node that is consumed by the OS may 
    now be supplied to the contrib/getmem.nwchem script.  Several small bugs
    in this script have also been fixed.

Tools:
  o BUG FIX: MPICH does not cause segmentation violations with RedHat 7.1.
  o BUG FIX: Parallel hangs have been fixed.

Installation availability: 

The current tested platforms and O/S versions are: 

  o IBM SP with P2SC nodes, AIX 4.3.2, and PSSP 3.1
  o IBM SP with silver nodes (SMP nodes with two 604e processors), AIX
    4.3.2, and PSSP 3.1. 
  o IBM SP with Power 3 nodes (SMP nodes with four processors), AIX 4.3.2
    and PSSP 3.1
  o IBM RS6000 workstation, AIX 4.1 and 4.3 
  o Cray T3E, 2.0.4.61 UNICOSMK 
  o SGI R8000/10000/12000 IRIX 6.5 
  o SUN workstations with Solaris 2.6 and 2.8
  o Compaq DEC alpha workstion (600 MHz EV6), Tru64 V4.0 and V5.0,
    DEC C V5.8-009, Digital Fortran V5.2 
  o Linux with Intel x86 cpus. Since there are at least 8 popular
    distributions of the Linux operating system and numerous others in
    existence, including downloading everything and building your own Linux OS,
    it is impossible to test all possible versions of Linux with NWChem.
    NWChem Release 4.0 has been tested on, RedHat 6.x and 7.x, Debian 2.2.1,
    Suse 6.4, TurboLinux 6.04, Mandrake 6.x and 7.x, FreeBSD 4.1.4.
    We have tested NWChem on Linux for the Power PC Macintosh with
    RedHat 6.x and Yellow Dog 2.1.
    These all use the GCC compiler at different levels. 
    The Intel Fortran Compiler has been tested on RedHat 6.x and 7.x.
    However, the Portland Group Compiler has 
    been tested in a less robust manner.
  o Linux with Alpha cpus has been tested with RedHat 6.1 and 6.2.
    Usage of the Compaq Fortran and C compilers is necessary for compiling.
  o HP 9000/800 workstations with  HPUX B.11.00. f90 must be used for
    compilation.
  o Intel x86 with Windows 98 and NT has been tested with Compaq Visual Fortran
    6.0 and 6.1 with WMPI 1.3 or NT-Mpich.
  o A preliminary port is available for Intel IA64 under Linux (with
    Intel compilers) and under HPUX. Not all QA tests have been
    succesful so far.
 

A general FAQ is available at 
http://www.emsl.pnl.gov:2080/docs/nwchem/support/NWChem_FAQ.html

A list of Known Bugs is available at
http://www.emsl.pnl.gov:2080/docs/nwchem/support/known_bugs.4.1.html







